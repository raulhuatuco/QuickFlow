\hypertarget{bar_8cpp_source}{}\subsection{bar.\+cpp}
\label{bar_8cpp_source}\index{bar.\+cpp@{bar.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{/*}
00002 \textcolor{comment}{ * The MIT License (MIT)}
00003 \textcolor{comment}{ *}
00004 \textcolor{comment}{ * Copyright (c) 2015 David Krepsky}
00005 \textcolor{comment}{ *}
00006 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}
00007 \textcolor{comment}{ * of this software and associated documentation files (the "Software"), to deal}
00008 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}
00009 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}
00010 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}
00011 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}
00012 \textcolor{comment}{ *}
00013 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in}
00014 \textcolor{comment}{ * all copies or substantial portions of the Software.}
00015 \textcolor{comment}{ *}
00016 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}
00017 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}
00018 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}
00019 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}
00020 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}
00021 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}
00022 \textcolor{comment}{ * SOFTWARE.}
00023 \textcolor{comment}{ */}
00024 
00043 \textcolor{preprocessor}{#include "\hyperlink{bar_8h}{models/bar.h}"}
00044 \textcolor{preprocessor}{#include <QGraphicsScene>}
00045 \textcolor{preprocessor}{#include <QPainter>}
00046 
00047 \textcolor{comment}{/*******************************************************************************}
00048 \textcolor{comment}{ * Const initialization.}
00049 \textcolor{comment}{ ******************************************************************************/}
00050 \textcolor{keyword}{const} int32\_t \hyperlink{group___models_ga9919592c0397ed41448dfb20b607d738}{Bar::kInvalidId} = -1;
00051 
00052 \textcolor{comment}{/*******************************************************************************}
00053 \textcolor{comment}{ * Constructor.}
00054 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00055}{}\hyperlink{group___models_ga9cae2188fcc6cce41caa7898c64548d1}{00055} \hyperlink{group___models_ga9cae2188fcc6cce41caa7898c64548d1}{Bar::Bar}()
00056   : QGraphicsObject(),
00057     id(kInvalidId),
00058     network(NULL),
00059     infoBar(NULL)
00060 \{
00061   setFlag(ItemIsSelectable);
00062   setFlag(ItemSendsGeometryChanges); \textcolor{comment}{// Needed to refresh line drawing.}
00063   setZValue(1.0); \textcolor{comment}{// Will be above lines and under info boxes.}
00064 
00065   \textcolor{comment}{// zero fill data.}
00066   \textcolor{keywordflow}{for} (int32\_t i = 0; i<=2; i++) \{
00067     v\_[i] = 0.0;
00068     sh\_[i] = 0.0;
00069     si\_[i] = 0.0;
00070     rV\_[i] = 0.0;
00071     rSi\_[i] = 0.0;
00072   \}
00073 \}
00074 
00075 \textcolor{comment}{/*******************************************************************************}
00076 \textcolor{comment}{ * Constructor with initial conditions.}
00077 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00078}{}\hyperlink{group___models_gab1c5a81ad40dbc7ee745077b4f5c20d4}{00078} \hyperlink{group___models_ga9cae2188fcc6cce41caa7898c64548d1}{Bar::Bar}(complex<double> initialV, complex<double> initialSh,
00079          complex<double> initialSi)
00080   : QGraphicsObject(),
00081     id(kInvalidId),
00082     network(NULL),
00083     infoBar(NULL)
00084 \{
00085   setFlag(ItemIsSelectable);
00086   setFlag(ItemSendsGeometryChanges); \textcolor{comment}{// Needed to refresh line drawing.}
00087   setZValue(1.0); \textcolor{comment}{// Will be above lines and under info boxes.}
00088 
00089   \textcolor{comment}{// Fill initial conditions.}
00090   \textcolor{keywordflow}{for} (int32\_t i = 0; i<=2; i++) \{
00091     v\_[i] = initialV;
00092     sh\_[i] = initialSh;
00093     si\_[i] = initialSi;
00094     \textcolor{comment}{// Results are still zero.}
00095     rV\_[i] = 0.0;
00096     rSi\_[i] = 0.0;
00097   \}
00098 \}
00099 
00100 \textcolor{comment}{/*******************************************************************************}
00101 \textcolor{comment}{ * Destructor.}
00102 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00103}{}\hyperlink{group___models_ga9c7ebea0c189423591741ac438985316}{00103} \hyperlink{group___models_ga9c7ebea0c189423591741ac438985316}{Bar::~Bar}()
00104 \{
00105   \textcolor{keywordflow}{if} (infoBar != NULL)
00106     \textcolor{keyword}{delete} infoBar;
00107 \}
00108 
00109 \textcolor{comment}{/*******************************************************************************}
00110 \textcolor{comment}{ * Initial Voltage.}
00111 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00112}{}\hyperlink{group___models_ga1e6f2daec86407118656d88170d1adc2}{00112} complex<double> \hyperlink{group___models_ga1e6f2daec86407118656d88170d1adc2}{Bar::v}(int32\_t phase, \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1}{Unit::VoltageUnit} unit)
00113 \{
00114   \textcolor{keywordflow}{switch} (unit) \{
00115   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1aa54b2473993a702a3923525765bd6e4c}{Unit::kVolts}:
00116     \textcolor{keywordflow}{return} v\_[phase];
00117     \textcolor{keywordflow}{break};
00118 
00119   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1a35a201a658c2cd89766787c657e9a54d}{Unit::kKiloVolts}:
00120     \textcolor{keywordflow}{return} v\_[phase]/1000.0;
00121     \textcolor{keywordflow}{break};
00122 
00123   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1ab44b1310b59fdcdc9df5bbea91da4206}{Unit::kVoltsPerUnit}:
00124     \textcolor{keywordflow}{return} v\_[phase]/\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase};
00125     \textcolor{keywordflow}{break};
00126 
00127   \textcolor{keywordflow}{default}:
00128     \textcolor{keywordflow}{return} v\_[phase];
00129     \textcolor{keywordflow}{break};
00130   \}
00131 \}
00132 
00133 \textcolor{comment}{/*******************************************************************************}
00134 \textcolor{comment}{ * Set initial Voltage.}
00135 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00136}{}\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{00136} \textcolor{keywordtype}{void} \hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{Bar::setV}(int32\_t phase, complex<double> newVoltage,
00137                \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1}{Unit::VoltageUnit} unit)
00138 \{
00139   \textcolor{keywordflow}{switch} (unit) \{
00140   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1aa54b2473993a702a3923525765bd6e4c}{Unit::kVolts}:
00141     v\_[phase] = newVoltage;
00142     \textcolor{keywordflow}{break};
00143 
00144   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1a35a201a658c2cd89766787c657e9a54d}{Unit::kKiloVolts}:
00145     v\_[phase] = newVoltage*1000.0;
00146     \textcolor{keywordflow}{break};
00147 
00148   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1ab44b1310b59fdcdc9df5bbea91da4206}{Unit::kVoltsPerUnit}:
00149     v\_[phase] = newVoltage*\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase};
00150     \textcolor{keywordflow}{break};
00151 
00152   \textcolor{keywordflow}{default}:
00153     v\_[phase] = newVoltage;
00154     \textcolor{keywordflow}{break};
00155   \}
00156 
00157   rV\_[phase] = v\_[phase];
00158 \}
00159 
00160 \textcolor{comment}{/*******************************************************************************}
00161 \textcolor{comment}{ * Get Shunt Element Power.}
00162 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00163}{}\hyperlink{group___models_gac188071bf5f165b0acdaa4c8af82355c}{00163} complex<double> \hyperlink{group___models_gac188071bf5f165b0acdaa4c8af82355c}{Bar::sh}(int32\_t phase, \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3b}{Unit::PowerUnit} unit)
00164 \{
00165   \textcolor{keywordflow}{switch} (unit) \{
00166   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba72b181a842ae2759488a2fa1410d3696}{Unit::kVA}:
00167     \textcolor{keywordflow}{return} sh\_[phase];
00168     \textcolor{keywordflow}{break};
00169 
00170   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA}:
00171     \textcolor{keywordflow}{return} sh\_[phase]/1000.0;
00172     \textcolor{keywordflow}{break};
00173 
00174   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba6039da0ed20f8bee64305bab8bdec365}{Unit::kMegaVa}:
00175     \textcolor{keywordflow}{return} sh\_[phase]/1000000.0;
00176     \textcolor{keywordflow}{break};
00177 
00178   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bae056e80d620a87c61a44c359e6b05cc1}{Unit::kVaPerUnit}:
00179     \textcolor{keywordflow}{return} sh\_[phase]/\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_ga74bb7aa495d422f1f092acdf958df989}{powerBase};
00180     \textcolor{keywordflow}{break};
00181 
00182   \textcolor{keywordflow}{default}:
00183     \textcolor{keywordflow}{return} sh\_[phase];
00184     \textcolor{keywordflow}{break};
00185   \}
00186 \}
00187 
00188 \textcolor{comment}{/*******************************************************************************}
00189 \textcolor{comment}{ * Set Shunt Element Power.}
00190 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00191}{}\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{00191} \textcolor{keywordtype}{void} \hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{Bar::setSh}(int32\_t phase, complex<double> newPower, 
      \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3b}{Unit::PowerUnit} unit)
00192 \{
00193   \textcolor{keywordflow}{switch} (unit) \{
00194   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba72b181a842ae2759488a2fa1410d3696}{Unit::kVA}:
00195     sh\_[phase] = newPower;
00196     \textcolor{keywordflow}{break};
00197 
00198   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA}:
00199     sh\_[phase] = newPower*1000.0;
00200     \textcolor{keywordflow}{break};
00201 
00202   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba6039da0ed20f8bee64305bab8bdec365}{Unit::kMegaVa}:
00203     sh\_[phase] = newPower*1000000.0;
00204     \textcolor{keywordflow}{break};
00205 
00206   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bae056e80d620a87c61a44c359e6b05cc1}{Unit::kVaPerUnit}:
00207     sh\_[phase] = newPower*\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_ga74bb7aa495d422f1f092acdf958df989}{powerBase};
00208     \textcolor{keywordflow}{break};
00209 
00210   \textcolor{keywordflow}{default}:
00211     sh\_[phase] = newPower;
00212     \textcolor{keywordflow}{break};
00213   \}
00214 \}
00215 
00216 \textcolor{comment}{/*******************************************************************************}
00217 \textcolor{comment}{ * Injected power.}
00218 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00219}{}\hyperlink{group___models_ga02bbc279f1e133f66b12ee21e7bebcd8}{00219} complex<double> \hyperlink{group___models_ga02bbc279f1e133f66b12ee21e7bebcd8}{Bar::si}(int32\_t phase, \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3b}{Unit::PowerUnit} unit)
00220 \{
00221   \textcolor{keywordflow}{switch} (unit) \{
00222   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba72b181a842ae2759488a2fa1410d3696}{Unit::kVA}:
00223     \textcolor{keywordflow}{return} si\_[phase];
00224     \textcolor{keywordflow}{break};
00225 
00226   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA}:
00227     \textcolor{keywordflow}{return} si\_[phase]/1000.0;
00228     \textcolor{keywordflow}{break};
00229 
00230   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba6039da0ed20f8bee64305bab8bdec365}{Unit::kMegaVa}:
00231     \textcolor{keywordflow}{return} si\_[phase]/1000000.0;
00232     \textcolor{keywordflow}{break};
00233 
00234   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bae056e80d620a87c61a44c359e6b05cc1}{Unit::kVaPerUnit}:
00235     \textcolor{keywordflow}{return} si\_[phase]/\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_ga74bb7aa495d422f1f092acdf958df989}{powerBase};
00236     \textcolor{keywordflow}{break};
00237 
00238   \textcolor{keywordflow}{default}:
00239     \textcolor{keywordflow}{return} si\_[phase];
00240     \textcolor{keywordflow}{break};
00241   \}
00242 \}
00243 
00244 \textcolor{comment}{/*******************************************************************************}
00245 \textcolor{comment}{ * Set Injected power.}
00246 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00247}{}\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{00247} \textcolor{keywordtype}{void} \hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{Bar::setSi}(int32\_t phase, complex<double> newPower, 
      \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3b}{Unit::PowerUnit} unit)
00248 \{
00249   \textcolor{keywordflow}{switch} (unit) \{
00250   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba72b181a842ae2759488a2fa1410d3696}{Unit::kVA}:
00251     si\_[phase] = newPower;
00252     \textcolor{keywordflow}{break};
00253 
00254   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA}:
00255     si\_[phase] = newPower*1000.0;
00256     \textcolor{keywordflow}{break};
00257 
00258   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba6039da0ed20f8bee64305bab8bdec365}{Unit::kMegaVa}:
00259     si\_[phase] = newPower*1000000.0;
00260     \textcolor{keywordflow}{break};
00261 
00262   \textcolor{keywordflow}{case} \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bae056e80d620a87c61a44c359e6b05cc1}{Unit::kVaPerUnit}:
00263     si\_[phase] = newPower*\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_ga74bb7aa495d422f1f092acdf958df989}{powerBase};
00264     \textcolor{keywordflow}{break};
00265 
00266   \textcolor{keywordflow}{default}:
00267     si\_[phase] = newPower;
00268     \textcolor{keywordflow}{break};
00269   \}
00270 \}
00271 
00272 \textcolor{comment}{/*******************************************************************************}
00273 \textcolor{comment}{ * Result voltage.}
00274 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00275}{}\hyperlink{group___models_ga2d1f6bfbd8abaf168bb75bd8e5cd9b5e}{00275} complex<double> \hyperlink{group___models_ga2d1f6bfbd8abaf168bb75bd8e5cd9b5e}{Bar::rV}(int32\_t phase, \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1}{Unit::VoltageUnit} unit)
00276 \{
00277   \textcolor{keywordflow}{switch} (unit) \{
00278   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1aa54b2473993a702a3923525765bd6e4c}{Unit::kVolts}:
00279     \textcolor{keywordflow}{return} rV\_[phase];
00280     \textcolor{keywordflow}{break};
00281 
00282   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1a35a201a658c2cd89766787c657e9a54d}{Unit::kKiloVolts}:
00283     \textcolor{keywordflow}{return} rV\_[phase]/1000.0;
00284     \textcolor{keywordflow}{break};
00285 
00286   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1ab44b1310b59fdcdc9df5bbea91da4206}{Unit::kVoltsPerUnit}:
00287     \textcolor{keywordflow}{return} rV\_[phase]/\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase};
00288     \textcolor{keywordflow}{break};
00289 
00290   \textcolor{keywordflow}{default}:
00291     \textcolor{keywordflow}{return} rV\_[phase];
00292     \textcolor{keywordflow}{break};
00293   \}
00294 \}
00295 
00296 \textcolor{comment}{/*******************************************************************************}
00297 \textcolor{comment}{ * Set result voltage.}
00298 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00299}{}\hyperlink{group___models_ga2b2c5a373d87025e79d26aa9c4cea75a}{00299} \textcolor{keywordtype}{void} \hyperlink{group___models_ga2b2c5a373d87025e79d26aa9c4cea75a}{Bar::setRV}(int32\_t phase, complex<double> resultVoltage,
00300                 \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1}{Unit::VoltageUnit} unit)
00301 \{
00302   \textcolor{keywordflow}{switch} (unit) \{
00303   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1aa54b2473993a702a3923525765bd6e4c}{Unit::kVolts}:
00304     rV\_[phase] = resultVoltage;
00305     \textcolor{keywordflow}{break};
00306 
00307   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1a35a201a658c2cd89766787c657e9a54d}{Unit::kKiloVolts}:
00308     rV\_[phase] = resultVoltage*1000.0;
00309     \textcolor{keywordflow}{break};
00310 
00311   \textcolor{keywordflow}{case} \hyperlink{class_unit_a55b07dfa9457e1eca2c7194fe0cfc3c1ab44b1310b59fdcdc9df5bbea91da4206}{Unit::kVoltsPerUnit}:
00312     rV\_[phase] = resultVoltage*\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase};
00313     \textcolor{keywordflow}{break};
00314 
00315   \textcolor{keywordflow}{default}:
00316     rV\_[phase] = resultVoltage;
00317     \textcolor{keywordflow}{break};
00318   \}
00319 \}
00320 
00321 \textcolor{comment}{/*******************************************************************************}
00322 \textcolor{comment}{ * Result value for bar current.}
00323 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00324}{}\hyperlink{group___models_ga8a009531f01430aa68eba739bb0dc2ea}{00324} complex<double> \hyperlink{group___models_ga8a009531f01430aa68eba739bb0dc2ea}{Bar::rI}(int32\_t phase, \hyperlink{class_unit_a0794cf6c9682f48296dd4a5315389787}{Unit::CurrentUnit} unit)
00325 \{
00326   complex<double> i;
00327 
00328   i = conj((si\_[phase]-sh\_[phase])/rV\_[phase]);
00329 
00330   \textcolor{keywordflow}{switch} (unit) \{
00331   \textcolor{keywordflow}{case} \hyperlink{class_unit_a0794cf6c9682f48296dd4a5315389787a368a3c470f0b590a6100dda717a7dd4f}{Unit::kAmpere}:
00332     \textcolor{keywordflow}{return} i;
00333     \textcolor{keywordflow}{break};
00334 
00335   \textcolor{keywordflow}{case} \hyperlink{class_unit_a0794cf6c9682f48296dd4a5315389787aa27cb5edd73099f24f2285e02396ae14}{Unit::kKiloAmpere}:
00336     \textcolor{keywordflow}{return} i/1000.0;
00337     \textcolor{keywordflow}{break};
00338 
00339   \textcolor{keywordflow}{case} \hyperlink{class_unit_a0794cf6c9682f48296dd4a5315389787aeed3b50e464d581cb630181a3b6a0709}{Unit::kAmperePerUnit}:
00340     \textcolor{keywordflow}{return} i/\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_ga433bc5c32cf2ce5329bb40b21952d885}{currentBase}();
00341     \textcolor{keywordflow}{break};
00342 
00343   \textcolor{keywordflow}{default}:
00344     \textcolor{keywordflow}{return} i;
00345     \textcolor{keywordflow}{break};
00346   \}
00347 \}
00348 
00349 \textcolor{comment}{/*******************************************************************************}
00350 \textcolor{comment}{ * addLine.}
00351 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00352}{}\hyperlink{group___models_ga8cbd2f62d92e69ce6c8d561b682464b6}{00352} \textcolor{keywordtype}{void} \hyperlink{group___models_ga8cbd2f62d92e69ce6c8d561b682464b6}{Bar::addLine}(\hyperlink{class_line}{Line} *line)
00353 \{
00354   \hyperlink{class_bar_a23b6d4319352ef0e77ad66aade4e0209}{lines}.append(line);
00355 \}
00356 
00357 \textcolor{comment}{/*******************************************************************************}
00358 \textcolor{comment}{ * removeLine.}
00359 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00360}{}\hyperlink{group___models_ga2536c0e5cb97fb627b3520826ece2c99}{00360} \textcolor{keywordtype}{void} \hyperlink{group___models_ga2536c0e5cb97fb627b3520826ece2c99}{Bar::removeLine}(\hyperlink{class_line}{Line} *line)
00361 \{
00362   \textcolor{keywordtype}{int} index = \hyperlink{class_bar_a23b6d4319352ef0e77ad66aade4e0209}{lines}.indexOf(line);
00363 
00364   \textcolor{keywordflow}{if} (index != -1) \hyperlink{class_bar_a23b6d4319352ef0e77ad66aade4e0209}{lines}.removeAt(index);
00365 \}
00366 
00367 \textcolor{comment}{/*******************************************************************************}
00368 \textcolor{comment}{ * removeLines.}
00369 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00370}{}\hyperlink{group___models_ga4ea1a2074cb45968d80d6add571884a4}{00370} \textcolor{keywordtype}{void} \hyperlink{group___models_ga4ea1a2074cb45968d80d6add571884a4}{Bar::removeLines}()
00371 \{
00372   \textcolor{keywordflow}{foreach} (\hyperlink{class_line}{Line} *line, \hyperlink{class_bar_a23b6d4319352ef0e77ad66aade4e0209}{lines}) \{
00373     line->\hyperlink{group___models_gaeafd90e84ac2f8de2a879abe9e53eef3}{pNoI}()->\hyperlink{group___models_ga2536c0e5cb97fb627b3520826ece2c99}{removeLine}(line);
00374     line->\hyperlink{group___models_gabbc73ddedd3075c33ae5331bd7c9829f}{pNoF}()->\hyperlink{group___models_ga2536c0e5cb97fb627b3520826ece2c99}{removeLine}(line);
00375     scene()->removeItem(line);
00376     \textcolor{keyword}{delete} line;
00377   \}
00378 \}
00379 
00380 \textcolor{comment}{/*******************************************************************************}
00381 \textcolor{comment}{ * toJson.}
00382 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00383}{}\hyperlink{group___models_ga3eb84c42b687db6cd98e11b8bd38c86e}{00383} QJsonObject \hyperlink{group___models_ga3eb84c42b687db6cd98e11b8bd38c86e}{Bar::toJson}()
00384 \{
00385   \textcolor{comment}{// Json Object to be filled with data.}
00386   QJsonObject jsonBar;
00387 
00388   \textcolor{comment}{// Bar Id.}
00389   jsonBar.insert(\textcolor{stringliteral}{"id"}, \textcolor{keywordtype}{id});
00390 
00391   \textcolor{comment}{// Voltage.}
00392   jsonBar.insert(\textcolor{stringliteral}{"Va"}, v\_[0].real());
00393   jsonBar.insert(\textcolor{stringliteral}{"Vai"}, v\_[0].imag());
00394   jsonBar.insert(\textcolor{stringliteral}{"Vb"}, v\_[1].real());
00395   jsonBar.insert(\textcolor{stringliteral}{"Vbi"}, v\_[1].imag());
00396   jsonBar.insert(\textcolor{stringliteral}{"Vc"}, v\_[2].real());
00397   jsonBar.insert(\textcolor{stringliteral}{"Vci"}, v\_[2].imag());
00398 
00399   \textcolor{comment}{// Shunt element power.}
00400   jsonBar.insert(\textcolor{stringliteral}{"Sha"}, sh\_[0].real());
00401   jsonBar.insert(\textcolor{stringliteral}{"Shai"}, sh\_[0].imag());
00402   jsonBar.insert(\textcolor{stringliteral}{"Shb"}, sh\_[1].real());
00403   jsonBar.insert(\textcolor{stringliteral}{"Shbi"}, sh\_[1].imag());
00404   jsonBar.insert(\textcolor{stringliteral}{"Shc"}, sh\_[2].real());
00405   jsonBar.insert(\textcolor{stringliteral}{"Shci"}, sh\_[2].imag());
00406 
00407   \textcolor{comment}{// Injected Power.}
00408   jsonBar.insert(\textcolor{stringliteral}{"Sia"}, si\_[0].real());
00409   jsonBar.insert(\textcolor{stringliteral}{"Siai"}, si\_[0].imag());
00410   jsonBar.insert(\textcolor{stringliteral}{"Sib"}, si\_[1].real());
00411   jsonBar.insert(\textcolor{stringliteral}{"Sibi"}, si\_[1].imag());
00412   jsonBar.insert(\textcolor{stringliteral}{"Sic"}, si\_[2].real());
00413   jsonBar.insert(\textcolor{stringliteral}{"Sici"}, si\_[2].imag());
00414 
00415   \textcolor{comment}{// Result Voltage.}
00416   jsonBar.insert(\textcolor{stringliteral}{"rVa"}, rV\_[0].real());
00417   jsonBar.insert(\textcolor{stringliteral}{"rVai"}, rV\_[0].imag());
00418   jsonBar.insert(\textcolor{stringliteral}{"rVb"}, rV\_[1].real());
00419   jsonBar.insert(\textcolor{stringliteral}{"rVbi"}, rV\_[1].imag());
00420   jsonBar.insert(\textcolor{stringliteral}{"rVc"}, rV\_[2].real());
00421   jsonBar.insert(\textcolor{stringliteral}{"rVci"}, rV\_[2].imag());
00422 
00423   \textcolor{comment}{// Result Injected Power.}
00424   jsonBar.insert(\textcolor{stringliteral}{"rSia"}, rSi\_[0].real());
00425   jsonBar.insert(\textcolor{stringliteral}{"rSiai"}, rSi\_[0].imag());
00426   jsonBar.insert(\textcolor{stringliteral}{"rSib"}, rSi\_[1].real());
00427   jsonBar.insert(\textcolor{stringliteral}{"rSibi"}, rSi\_[1].imag());
00428   jsonBar.insert(\textcolor{stringliteral}{"rSic"}, rSi\_[2].real());
00429   jsonBar.insert(\textcolor{stringliteral}{"rSici"}, rSi\_[2].imag());
00430 
00431   \textcolor{comment}{// Position.}
00432   jsonBar.insert(\textcolor{stringliteral}{"x"}, x());
00433   jsonBar.insert(\textcolor{stringliteral}{"y"}, y());
00434 
00435   \textcolor{keywordflow}{return} jsonBar;
00436 \}
00437 
00438 \textcolor{comment}{/*******************************************************************************}
00439 \textcolor{comment}{ * fromJson.}
00440 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00441}{}\hyperlink{group___models_ga1df62f03dd3a066ceaf6588ba6bb6004}{00441} \textcolor{keywordtype}{void} \hyperlink{group___models_ga1df62f03dd3a066ceaf6588ba6bb6004}{Bar::fromJson}(QJsonObject &jsonBar)
00442 \{
00443   \textcolor{comment}{// Get Id.}
00444   \textcolor{keywordtype}{id} = jsonBar.value(\textcolor{stringliteral}{"id"}).toInt();
00445 
00446   \textcolor{comment}{// Voltage.}
00447   v\_[0].real(jsonBar.value(\textcolor{stringliteral}{"Va"}).toDouble());
00448   v\_[0].imag(jsonBar.value(\textcolor{stringliteral}{"Vai"}).toDouble());
00449   v\_[1].real(jsonBar.value(\textcolor{stringliteral}{"Vb"}).toDouble());
00450   v\_[1].imag(jsonBar.value(\textcolor{stringliteral}{"Vbi"}).toDouble());
00451   v\_[2].real(jsonBar.value(\textcolor{stringliteral}{"Vc"}).toDouble());
00452   v\_[2].imag(jsonBar.value(\textcolor{stringliteral}{"Vci"}).toDouble());
00453 
00454   \textcolor{comment}{// Shunt element power.}
00455   sh\_[0].real(jsonBar.value(\textcolor{stringliteral}{"Sha"}).toDouble());
00456   sh\_[0].imag(jsonBar.value(\textcolor{stringliteral}{"Shai"}).toDouble());
00457   sh\_[1].real(jsonBar.value(\textcolor{stringliteral}{"Shb"}).toDouble()) ;
00458   sh\_[1].imag(jsonBar.value(\textcolor{stringliteral}{"Shbi"}).toDouble());
00459   sh\_[2].real(jsonBar.value(\textcolor{stringliteral}{"Shc"}).toDouble());
00460   sh\_[2].imag(jsonBar.value(\textcolor{stringliteral}{"Shci"}).toDouble());
00461 
00462   \textcolor{comment}{// Injected Power.}
00463   si\_[0].real(jsonBar.value(\textcolor{stringliteral}{"Sia"}).toDouble());
00464   si\_[0].imag(jsonBar.value(\textcolor{stringliteral}{"Siai"}).toDouble());
00465   si\_[1].real(jsonBar.value(\textcolor{stringliteral}{"Sib"}).toDouble());
00466   si\_[1].imag(jsonBar.value(\textcolor{stringliteral}{"Sibi"}).toDouble());
00467   si\_[2].real(jsonBar.value(\textcolor{stringliteral}{"Sic"}).toDouble());
00468   si\_[2].imag(jsonBar.value(\textcolor{stringliteral}{"Sici"}).toDouble());
00469 
00470   \textcolor{comment}{// Result Voltage.}
00471   rV\_[0].real(jsonBar.value(\textcolor{stringliteral}{"rVa"}).toDouble());
00472   rV\_[0].imag(jsonBar.value(\textcolor{stringliteral}{"rVai"}).toDouble());
00473   rV\_[1].real(jsonBar.value(\textcolor{stringliteral}{"rVb"}).toDouble());
00474   rV\_[1].imag(jsonBar.value(\textcolor{stringliteral}{"rVbi"}).toDouble());
00475   rV\_[2].real(jsonBar.value(\textcolor{stringliteral}{"rVc"}).toDouble());
00476   rV\_[2].imag(jsonBar.value(\textcolor{stringliteral}{"rVci"}).toDouble());
00477 
00478   \textcolor{comment}{// Result Injected Power.}
00479   rSi\_[0].real(jsonBar.value(\textcolor{stringliteral}{"rSga"}).toDouble());
00480   rSi\_[0].imag(jsonBar.value(\textcolor{stringliteral}{"rSgai"}).toDouble());
00481   rSi\_[1].real(jsonBar.value(\textcolor{stringliteral}{"rSgb"}).toDouble());
00482   rSi\_[1].imag(jsonBar.value(\textcolor{stringliteral}{"rSgbi"}).toDouble());
00483   rSi\_[2].real(jsonBar.value(\textcolor{stringliteral}{"rSgc"}).toDouble());
00484   rSi\_[2].imag(jsonBar.value(\textcolor{stringliteral}{"rSgci"}).toDouble());
00485 
00486   \textcolor{comment}{// Get Position.}
00487   setX(jsonBar.value(\textcolor{stringliteral}{"x"}).toDouble());
00488   setY(jsonBar.value(\textcolor{stringliteral}{"y"}).toDouble());
00489 \}
00490 
00491 \textcolor{comment}{/*******************************************************************************}
00492 \textcolor{comment}{ * boundingRect.}
00493 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00494}{}\hyperlink{group___models_ga8279d8109019cc7e139e2023690496be}{00494} QRectF \hyperlink{group___models_ga8279d8109019cc7e139e2023690496be}{Bar::boundingRect}()\textcolor{keyword}{ const}
00495 \textcolor{keyword}{}\{
00496   \textcolor{keywordflow}{return} QRectF(-\hyperlink{group___graphics_gaa334bbc93b3fde219840e95e23198b53}{Network::barIconSize} / 2 + \hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->
      \hyperlink{class_network_a9f5c70be28a45320802bd0ac3947d114}{xOffset},
00497                 -\hyperlink{group___graphics_gaa334bbc93b3fde219840e95e23198b53}{Network::barIconSize} / 2 + \hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->
      \hyperlink{class_network_a771b16f7eb4459d0ca7141c048b1ab59}{yOffset},
00498                 \hyperlink{group___graphics_gaa334bbc93b3fde219840e95e23198b53}{Network::barIconSize}, \hyperlink{group___graphics_gaa334bbc93b3fde219840e95e23198b53}{Network::barIconSize});
00499 \}
00500 
00501 \textcolor{comment}{/*******************************************************************************}
00502 \textcolor{comment}{ * mouseDoubleClickEvent.}
00503 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00504}{}\hyperlink{group___models_ga1945e7b4401fa9ad7475274d9fb12a72}{00504} \textcolor{keywordtype}{void} \hyperlink{group___models_ga1945e7b4401fa9ad7475274d9fb12a72}{Bar::mouseDoubleClickEvent}(QGraphicsSceneMouseEvent *event)
00505 \{
00506   Q\_UNUSED(event);
00507   emit \hyperlink{class_bar_a66bcbd19582dddee7e171ae5a4475f4b}{eventDoubleClick}();
00508 \}
00509 
00510 \textcolor{comment}{/*******************************************************************************}
00511 \textcolor{comment}{ * itemChange.}
00512 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00513}{}\hyperlink{group___models_gad97a82d618ee0c51a9a36e44339c69e6}{00513} QVariant \hyperlink{group___models_gad97a82d618ee0c51a9a36e44339c69e6}{Bar::itemChange}(QGraphicsItem::GraphicsItemChange change,
00514                          \textcolor{keyword}{const} QVariant &value)
00515 \{
00516   \textcolor{comment}{// if bar moved,update lines to the current position.}
00517   \textcolor{keywordflow}{if} (change == ItemPositionHasChanged) \{
00518     \textcolor{keywordflow}{foreach} (\hyperlink{class_line}{Line} *line, \hyperlink{class_bar_a23b6d4319352ef0e77ad66aade4e0209}{lines}) \{
00519       line->\hyperlink{group___models_ga8fdb12651d4bc592616d241386b066b3}{updatePosition}();
00520     \}
00521   \}
00522   \textcolor{comment}{// if bar is selected, show information box.}
00523   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (change == ItemSelectedChange) \{
00524     \textcolor{keywordflow}{if} (value == \textcolor{keyword}{true}) \{
00525       \textcolor{comment}{// if multiple bars are selectec, we don't want to show the info box.}
00526       \textcolor{keywordflow}{if}(!(scene()->selectedItems().size() > 1)) \{
00527         \textcolor{comment}{// Check if box already exists.}
00528         \textcolor{keywordflow}{if} (infoBar == NULL) \{
00529           \textcolor{comment}{// Create a new box.}
00530           infoBar = \textcolor{keyword}{new} \hyperlink{class_info_bar}{InfoBar}(\textcolor{keyword}{this});
00531           scene()->addItem(infoBar);
00532         \}
00533       \}
00534     \}
00535     \textcolor{comment}{// Box has been deselected.}
00536     \textcolor{keywordflow}{else} \{
00537       \textcolor{keywordflow}{if} (infoBar != NULL) \{
00538         scene()->removeItem(infoBar);
00539         \textcolor{keyword}{delete} infoBar;
00540         infoBar = NULL;
00541       \}
00542     \}
00543   \}
00544 
00545   \textcolor{keywordflow}{return} QGraphicsObject::itemChange(change, value);
00546 \}
00547 
00548 \textcolor{comment}{/*******************************************************************************}
00549 \textcolor{comment}{ * paint.}
00550 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{bar_8cpp_source_l00551}{}\hyperlink{group___models_gacbb6dbac607412c9c1f9dfcd0cd4d432}{00551} \textcolor{keywordtype}{void} \hyperlink{group___models_gacbb6dbac607412c9c1f9dfcd0cd4d432}{Bar::paint}(QPainter *painter, \textcolor{keyword}{const} QStyleOptionGraphicsItem *option,
00552                 QWidget *widget)
00553 \{
00554   Q\_UNUSED(option);
00555   Q\_UNUSED(widget);
00556 
00557   painter->setPen(\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{class_network_ad69052271ab0a9899948815b6201f2c6}{barStrokeColor});
00558 
00559   \textcolor{keywordflow}{if}(\textcolor{keywordtype}{id} > 0)
00560     drawPq(painter);
00561   \textcolor{keywordflow}{else}
00562     drawSlack(painter);
00563 
00564 \}
00565 
00566 \textcolor{comment}{/*******************************************************************************}
00567 \textcolor{comment}{ * drawSlack.}
00568 \textcolor{comment}{ ******************************************************************************/}
00569 \textcolor{keywordtype}{void} Bar::drawSlack(QPainter *painter)
00570 \{
00571   \textcolor{keywordflow}{if} (isSelected()) \{
00572     painter->setBrush(\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_gaa9e21b8e2a24b0495e776a51e1aeed94}{selectedColor});
00573   \} \textcolor{keywordflow}{else} \{
00574     painter->setBrush(\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{class_network_ad78d9a206daf4ba0780067b5043c7f5c}{barSlackFillColor});
00575   \}
00576 
00577   painter->drawRect(\hyperlink{group___models_ga8279d8109019cc7e139e2023690496be}{boundingRect}());
00578 \}
00579 
00580 \textcolor{comment}{/*******************************************************************************}
00581 \textcolor{comment}{ * drawPq.}
00582 \textcolor{comment}{ ******************************************************************************/}
00583 \textcolor{keywordtype}{void} Bar::drawPq(QPainter *painter)
00584 \{
00585 
00586   \textcolor{keywordflow}{if} (isSelected()) \{
00587     painter->setBrush(\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{group___graphics_gaa9e21b8e2a24b0495e776a51e1aeed94}{selectedColor});
00588   \} \textcolor{keywordflow}{else} \{
00589     painter->setBrush(\hyperlink{class_bar_a80025f13884750add58cc61b318357ff}{network}->\hyperlink{class_network_a386f492f548ec13f5d0e350c4f2217aa}{barPqFillColor});
00590   \}
00591 
00592   painter->drawEllipse(\hyperlink{group___models_ga8279d8109019cc7e139e2023690496be}{boundingRect}());
00593 \}
00594 
\end{DoxyCode}
