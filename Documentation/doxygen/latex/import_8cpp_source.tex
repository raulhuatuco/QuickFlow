\hypertarget{import_8cpp_source}{}\subsection{import.\+cpp}
\label{import_8cpp_source}\index{import.\+cpp@{import.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\hyperlink{import_8h}{algorithms/import.h}"}
00002 \textcolor{preprocessor}{#include <QtGui>}
00003 \textcolor{preprocessor}{#include <QtCore>}
00004 \textcolor{preprocessor}{#include <QtWidgets>}
00005 \textcolor{preprocessor}{#include "\hyperlink{network_8h}{models/network.h}"}
00006 \textcolor{preprocessor}{#include "\hyperlink{redrawnetwork_8h}{algorithms/redrawnetwork.h}"}
00007 
00008 \textcolor{keyword}{static} int32\_t getNextLineInt(QTextStream *stream, QString keyWord,
00009                               int32\_t *intVal)
00010 \{
00011   QString lineTxt; \textcolor{comment}{// Line text.}
00012   int32\_t lineCnt = 0; \textcolor{comment}{// Count the amount of processed lines.}
00013 
00014   \textcolor{comment}{// Loop until keyWord is found or EoF.}
00015   \textcolor{keywordflow}{do} \{
00016     \textcolor{keywordflow}{if}(stream->atEnd())
00017       \textcolor{keywordflow}{return} -1;
00018 
00019     lineTxt = stream->readLine();
00020     lineCnt++;
00021   \} \textcolor{keywordflow}{while}(!lineTxt.contains(keyWord));
00022 
00023   \textcolor{comment}{// Get integer value.}
00024   *stream >> *intVal;
00025   \textcolor{keywordflow}{return} lineCnt;
00026 \}
00027 
\hypertarget{import_8cpp_source_l00028}{}\hyperlink{import_8h_ab30ac380d5e14f830ebc8eb839fbbdf0}{00028} \textcolor{keywordtype}{bool} \hyperlink{import_8cpp_ab30ac380d5e14f830ebc8eb839fbbdf0}{importTxtType1}(QString &fileName, \hyperlink{class_network}{Network} *network)
00029 \{
00030   \textcolor{comment}{// Create project with file settings.}
00031   QFile file(fileName);
00032 
00033   \textcolor{keywordflow}{if}(!file.open(QFile::ReadOnly)) \{
00034     QMessageBox::critical(NULL, \textcolor{stringliteral}{"File read error."},
00035                           \textcolor{stringliteral}{"Can\(\backslash\)'t read "} + file.fileName() + \textcolor{stringliteral}{"."},
00036                           QMessageBox::Ok);
00037     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00038   \}
00039 
00040   \textcolor{comment}{// Auxiliaty variables.}
00041   QTextStream stream(&file); \textcolor{comment}{// Text stream used to parse lines.}
00042   int32\_t lineCnt = 0; \textcolor{comment}{// Current line counter, used to report errors.}
00043   int32\_t processedLines = 0; \textcolor{comment}{// Number of lines parsed during get methods.}
00044 
00045   \textcolor{comment}{// Read Number of bars.}
00046   int32\_t numBar;
00047   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"NumBarras"}, &numBar);
00048 
00049   \textcolor{keywordflow}{if}(processedLines == -1) \{
00050     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00051                           \textcolor{stringliteral}{"The file "} + fileName +
00052                           \textcolor{stringliteral}{" doesn't provide NumBarras."},
00053                           QMessageBox::Ok);
00054     file.close();
00055     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00056   \}
00057 
00058   lineCnt += processedLines;
00059 
00060   \textcolor{comment}{// Read Number of lines.}
00061   int32\_t numLine;
00062   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"NumLinhas"}, &numLine);
00063 
00064   \textcolor{keywordflow}{if}(processedLines == -1) \{
00065     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00066                           \textcolor{stringliteral}{"The file "} + fileName +
00067                           \textcolor{stringliteral}{" doesn't provide NumLinhas."},
00068                           QMessageBox::Ok);
00069     file.close();
00070     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00071   \}
00072 
00073   lineCnt += processedLines;
00074 
00075   \textcolor{comment}{// Get Length Unit.}
00076   int32\_t LenUn;
00077   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"comprimento\_das\_linhas"}, &LenUn);
00078 
00079   \textcolor{keywordflow}{if}(processedLines == -1) \{
00080     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00081                           \textcolor{stringliteral}{"The file "} + fileName +
00082                           \textcolor{stringliteral}{" doesn't provide Length Unit."},
00083                           QMessageBox::Ok);
00084     file.close();
00085     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00086   \}
00087 
00088   lineCnt += processedLines;
00089 
00090   \textcolor{comment}{// Cast to Unit enum.}
00091   \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0}{Unit::LengthUnit} lengthUnit;
00092 
00093   \textcolor{keywordflow}{switch} (LenUn) \{
00094   \textcolor{keywordflow}{case} 1:
00095     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0abfa41ebe7ee649a1f02c9b8ae570434b}{Unit::kMeter};
00096     \textcolor{keywordflow}{break};
00097 
00098   \textcolor{keywordflow}{case} 2:
00099     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0a1c04f3dd196dbe1832a2658215b0d919}{Unit::kKiloMeter};
00100     \textcolor{keywordflow}{break};
00101 
00102   \textcolor{keywordflow}{case} 3:
00103     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0a9ac9b167b0ebce477fb53d6ace04ddc8}{Unit::kFeet};
00104     \textcolor{keywordflow}{break};
00105 
00106   \textcolor{keywordflow}{case} 4:
00107     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0a2ebde742068bbee0510de32fbb4cd724}{Unit::kMile};
00108     \textcolor{keywordflow}{break};
00109 
00110   \textcolor{keywordflow}{default}:
00111     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0abfa41ebe7ee649a1f02c9b8ae570434b}{Unit::kMeter};
00112     \textcolor{keywordflow}{break};
00113   \}
00114 
00115   \textcolor{comment}{// Get Impedance Unit.}
00116   int32\_t ImpUn;
00117   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"impedancia"}, &ImpUn);
00118 
00119   \textcolor{keywordflow}{if}(processedLines == -1) \{
00120     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00121                           \textcolor{stringliteral}{"The file "} + fileName +
00122                           \textcolor{stringliteral}{" doesn't provide Impedance Unit."},
00123                           QMessageBox::Ok);
00124     file.close();
00125     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00126   \}
00127 
00128   lineCnt += processedLines;
00129 
00130 \textcolor{comment}{// Convert to enum.}
00131   \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdf}{Unit::ImpedanceUnit} impedanceUnit;
00132 
00133   \textcolor{keywordflow}{switch} (ImpUn) \{
00134   \textcolor{keywordflow}{case} 1:
00135     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa6b9c74d1763eefbaf751eeecff0bd9da}{Unit::kOhm};
00136     \textcolor{keywordflow}{break};
00137 
00138   \textcolor{keywordflow}{case} 2:
00139     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa35e9ca44deb5a35fdb576111cf0db336}{Unit::kOhmPerMeter};
00140     \textcolor{keywordflow}{break};
00141 
00142   \textcolor{keywordflow}{case} 3:
00143     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa56a0289d2ddeff7ca4aa8ba410df79d6}{Unit::kOhmPerKilometer};
00144     \textcolor{keywordflow}{break};
00145 
00146   \textcolor{keywordflow}{case} 4:
00147     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa433b57934ca3be960ec7a60f3ea6ea87}{Unit::kOhmPerFeet};
00148     \textcolor{keywordflow}{break};
00149 
00150   \textcolor{keywordflow}{case} 5:
00151     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa1d5bb04c9ecda66b09891af21cd4f613}{Unit::kOhmPerMile};
00152     \textcolor{keywordflow}{break};
00153 
00154   \textcolor{keywordflow}{default}:
00155     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa6b9c74d1763eefbaf751eeecff0bd9da}{Unit::kOhm};
00156     \textcolor{keywordflow}{break};
00157   \}
00158 
00159   \textcolor{comment}{// Get power Unit.}
00160   int32\_t powerUn;
00161   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"Demanda"}, &powerUn);
00162 
00163   \textcolor{keywordflow}{if}(processedLines == -1) \{
00164     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00165                           \textcolor{stringliteral}{"The file "} + fileName +
00166                           \textcolor{stringliteral}{" doesn't provide Power Init."},
00167                           QMessageBox::Ok);
00168     file.close();
00169     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00170   \}
00171 
00172   lineCnt += processedLines;
00173 
00174   \textcolor{comment}{// Convert to enum.}
00175   \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3b}{Unit::PowerUnit} powerUnit;
00176 
00177   \textcolor{keywordflow}{switch} (powerUn) \{
00178   \textcolor{keywordflow}{case} 1:
00179     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba72b181a842ae2759488a2fa1410d3696}{Unit::kVA};
00180     \textcolor{keywordflow}{break};
00181 
00182   \textcolor{keywordflow}{case} 2:
00183     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA};
00184     \textcolor{keywordflow}{break};
00185 
00186   \textcolor{keywordflow}{case} 3:
00187     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba6039da0ed20f8bee64305bab8bdec365}{Unit::kMegaVa};
00188     \textcolor{keywordflow}{break};
00189 
00190   \textcolor{keywordflow}{default}:
00191     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA};
00192     \textcolor{keywordflow}{break};
00193   \}
00194 
00195   \textcolor{comment}{// Get Bars.}
00196   QString lineTxt;
00197 
00198   \textcolor{keywordflow}{do} \{
00199     lineTxt = stream.readLine();
00200     lineCnt++;
00201 
00202     \textcolor{keywordflow}{if}(stream.atEnd()) \{
00203       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00204                             \textcolor{stringliteral}{"The file "} + fileName + \textcolor{stringliteral}{" doesn't provide bars."},
00205                             QMessageBox::Ok);
00206       file.close();
00207       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00208     \}
00209   \} \textcolor{keywordflow}{while}(!lineTxt.contains(\textcolor{stringliteral}{"[n"}));
00210 
00211   int32\_t id;
00212   int32\_t barType;
00213   \textcolor{keywordtype}{double} Sia, Siai;
00214   \textcolor{keywordtype}{double} Sib, Sibi;
00215   \textcolor{keywordtype}{double} Sic, Sici;
00216   \textcolor{keywordtype}{double} Sha, Shai;
00217   \textcolor{keywordtype}{double} Shb, Shbi;
00218   \textcolor{keywordtype}{double} Shc, Shci;
00219 
00220   int32\_t idBase = 0;
00221 
00222   \hyperlink{class_bar}{Bar} *bar;
00223 
00224   \textcolor{keywordflow}{for}(int32\_t i=0; i<numBar; i++) \{
00225     stream >> \textcolor{keywordtype}{id} >> barType >> Sia >> Siai >> Sib >> Sibi >> Sic >> Sici;
00226     stream >> Sha >> Shai >> Shb >> Shbi >> Shc >>Shci;
00227 
00228     \textcolor{keywordflow}{if}(barType == 3)
00229       idBase = id;
00230 
00231     bar = \textcolor{keyword}{new} \hyperlink{class_bar}{Bar};
00232     bar->\hyperlink{class_bar_a9dc5c6a6d44fe412ae34ef8a881b8dce}{id} = \textcolor{keywordtype}{id} - idBase;
00233 
00234     bar->\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{setSh}(0, complex<double>(Sha, Shai), powerUnit);
00235     bar->\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{setSh}(1, complex<double>(Shb, Shbi), powerUnit);
00236     bar->\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{setSh}(2, complex<double>(Shc, Shci), powerUnit);
00237 
00238     bar->\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{setSi}(0, complex<double>(Sia, Siai), powerUnit);
00239     bar->\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{setSi}(1, complex<double>(Sib, Sibi), powerUnit);
00240     bar->\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{setSi}(2, complex<double>(Sic, Sici), powerUnit);
00241 
00242 
00243     \textcolor{keywordflow}{if} (!network->\hyperlink{group___graphics_ga8c5dfef0216731246f7411e1a5fbee01}{addBar}(bar)) \{
00244       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid Bar."},
00245                             \textcolor{stringliteral}{"Invalid Bar "} + QString::number(\textcolor{keywordtype}{id}) + \textcolor{stringliteral}{"at line "} +
00246                             QString::number(lineCnt) + \textcolor{stringliteral}{"."},
00247                             QMessageBox::Ok);
00248       \textcolor{keyword}{delete} bar;
00249       file.close();
00250       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00251     \}
00252 
00253     \textcolor{comment}{// Set Initial voltage to 1pu.}
00254     bar->\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{setV}(0, std::polar(network->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase}/sqrt(3), 0.0));
00255     bar->\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{setV}(1, std::polar(network->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase}/sqrt(3), 0.0));
00256     bar->\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{setV}(2, std::polar(network->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase}/sqrt(3), 0.0));
00257 
00258     lineTxt = stream.readLine();
00259     lineCnt++;
00260   \}
00261 
00262   \textcolor{comment}{// Get Lines.}
00263   \textcolor{keywordflow}{do} \{
00264     \textcolor{keywordflow}{if}(stream.atEnd()) \{
00265       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00266                             \textcolor{stringliteral}{"The file "} + fileName + \textcolor{stringliteral}{" doesn't provide lines."},
00267                             QMessageBox::Ok);
00268       file.close();
00269       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00270     \}
00271 
00272     lineTxt = stream.readLine();
00273     lineCnt++;
00274   \} \textcolor{keywordflow}{while}(!lineTxt.contains(\textcolor{stringliteral}{"Tipo\_Cir"}));
00275 
00276   int32\_t noI, noF;
00277   \textcolor{keywordtype}{double} Zaa, Zaai;
00278   \textcolor{keywordtype}{double} Zab, Zabi;
00279   \textcolor{keywordtype}{double} Zac, Zaci;
00280   \textcolor{keywordtype}{double} Zbb, Zbbi;
00281   \textcolor{keywordtype}{double} Zbc, Zbci;
00282   \textcolor{keywordtype}{double} Zcc, Zcci;
00283   \textcolor{keywordtype}{double} length;
00284   QString dummy;
00285 
00286   \hyperlink{class_line}{Line} *line;
00287 
00288   \textcolor{keywordflow}{for}(int32\_t i=0; i<numLine; i++) \{
00289     stream >> dummy >> noI >> noF >> dummy >> dummy >> dummy >> dummy >> Zaa >> Zaai
00290            >> Zbb >> Zbbi >> Zcc;
00291     stream >> Zcci >> dummy >> dummy >> Zab >> Zabi >> Zac >> Zaci >> dummy >>
00292            dummy;
00293     stream >> Zbc >> Zbci >> dummy >> dummy >> dummy >> dummy >> dummy >>   length;
00294 
00295     line = \textcolor{keyword}{new} \hyperlink{class_line}{Line};
00296     line->\hyperlink{class_line_afd17c40d656e6a8d677cb22df5f0c70b}{nodes}.first = noI - idBase;
00297     line->\hyperlink{class_line_afd17c40d656e6a8d677cb22df5f0c70b}{nodes}.second = noF - idBase;
00298 
00299     line->\hyperlink{group___models_ga950d0b8f5d167eda430c65ca7adadbb0}{setLength}(length, lengthUnit);
00300 
00301     line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(0, complex<double>(Zaa, Zaai), impedanceUnit);
00302     line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(1, complex<double>(Zab, Zabi), impedanceUnit);
00303     line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(2, complex<double>(Zac, Zaci), impedanceUnit);
00304     line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(3, complex<double>(Zbb, Zbbi), impedanceUnit);
00305     line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(4, complex<double>(Zbc, Zbci), impedanceUnit);
00306     line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(5, complex<double>(Zcc, Zcci), impedanceUnit);
00307 
00308     \textcolor{keywordflow}{if} (!network->\hyperlink{group___graphics_gae02945131494987b3ff9b59b627719b4}{addLine}(line)) \{
00309       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid Line."},
00310                             \textcolor{stringliteral}{"Invalid Line at line "} +
00311                             QString::number(lineCnt) + \textcolor{stringliteral}{"."},
00312                             QMessageBox::Ok);
00313       \textcolor{keyword}{delete} line;
00314       file.close();
00315       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00316     \}
00317 
00318     lineTxt = stream.readLine();
00319     lineCnt++;
00320   \}
00321 
00322   \hyperlink{class_redraw_network}{RedrawNetwork} redraw(network);
00323   redraw.\hyperlink{class_redraw_network_a94d53ddf8ee00c4ef6d56bb988333103}{sugiyamaFast}();
00324 
00325   file.close();
00326   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
00327 \}
00328 
\hypertarget{import_8cpp_source_l00329}{}\hyperlink{import_8h_aef466de21b145a0fdf215dd1a6409924}{00329} \textcolor{keywordtype}{bool} \hyperlink{import_8cpp_aef466de21b145a0fdf215dd1a6409924}{importTxtType2}(QString &fileName, \hyperlink{class_network}{Network} *network)
00330 \{
00331   QFile file(fileName);
00332 
00333   \textcolor{keywordflow}{if}(!file.open(QFile::ReadOnly)) \{
00334     QMessageBox::critical(NULL, \textcolor{stringliteral}{"File read error."},
00335                           \textcolor{stringliteral}{"Can\(\backslash\)'t read "} + file.fileName() + \textcolor{stringliteral}{"."},
00336                           QMessageBox::Ok);
00337     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00338   \}
00339 
00340   \textcolor{comment}{// Auxiliaty variables.}
00341   QTextStream stream(&file); \textcolor{comment}{// Text stream used to parse lines.}
00342   int32\_t lineCnt = 0; \textcolor{comment}{// Current line counter, used to report errors.}
00343   int32\_t processedLines = 0; \textcolor{comment}{// Number of lines parsed during get methods.}
00344 
00345   \textcolor{comment}{// Read Number of bars.}
00346   int32\_t numBar;
00347   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"Numero\_barras"}, &numBar);
00348 
00349   \textcolor{keywordflow}{if}(processedLines == -1) \{
00350     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00351                           \textcolor{stringliteral}{"The file "} + fileName +
00352                           \textcolor{stringliteral}{" doesn't provide Numero\_barras."},
00353                           QMessageBox::Ok);
00354     file.close();
00355     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00356   \}
00357 
00358   lineCnt += processedLines;
00359 
00360   \textcolor{comment}{// Read Number of lines.}
00361   int32\_t numLine;
00362   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"Numero\_linhas"}, &numLine);
00363 
00364   \textcolor{keywordflow}{if}(processedLines == -1) \{
00365     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00366                           \textcolor{stringliteral}{"The file "} + fileName +
00367                           \textcolor{stringliteral}{" doesn't provide Numero\_linhas."},
00368                           QMessageBox::Ok);
00369     file.close();
00370     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00371   \}
00372 
00373   lineCnt += processedLines;
00374 
00375   \textcolor{comment}{// Get Length Unit.}
00376   int32\_t LenUn;
00377   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"comprimento\_das\_linhas"}, &LenUn);
00378 
00379   \textcolor{keywordflow}{if}(processedLines == -1) \{
00380     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00381                           \textcolor{stringliteral}{"The file "} + fileName +
00382                           \textcolor{stringliteral}{" doesn't provide Length Unit."},
00383                           QMessageBox::Ok);
00384     file.close();
00385     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00386   \}
00387 
00388   lineCnt += processedLines;
00389 
00390   \textcolor{comment}{// Cast to Unit enum.}
00391   \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0}{Unit::LengthUnit} lengthUnit;
00392 
00393   \textcolor{keywordflow}{switch} (LenUn) \{
00394   \textcolor{keywordflow}{case} 1:
00395     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0abfa41ebe7ee649a1f02c9b8ae570434b}{Unit::kMeter};
00396     \textcolor{keywordflow}{break};
00397 
00398   \textcolor{keywordflow}{case} 2:
00399     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0a1c04f3dd196dbe1832a2658215b0d919}{Unit::kKiloMeter};
00400     \textcolor{keywordflow}{break};
00401 
00402   \textcolor{keywordflow}{case} 3:
00403     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0a9ac9b167b0ebce477fb53d6ace04ddc8}{Unit::kFeet};
00404     \textcolor{keywordflow}{break};
00405 
00406   \textcolor{keywordflow}{case} 4:
00407     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0a2ebde742068bbee0510de32fbb4cd724}{Unit::kMile};
00408     \textcolor{keywordflow}{break};
00409 
00410   \textcolor{keywordflow}{default}:
00411     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0abfa41ebe7ee649a1f02c9b8ae570434b}{Unit::kMeter};
00412     \textcolor{keywordflow}{break};
00413   \}
00414 
00415   \textcolor{comment}{// Get Impedance Unit.}
00416   int32\_t ImpUn;
00417   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"impedancia"}, &ImpUn);
00418 
00419   \textcolor{keywordflow}{if}(processedLines == -1) \{
00420     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00421                           \textcolor{stringliteral}{"The file "} + fileName +
00422                           \textcolor{stringliteral}{" doesn't provide Impedance Unit."},
00423                           QMessageBox::Ok);
00424     file.close();
00425     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00426   \}
00427 
00428   lineCnt += processedLines;
00429 
00430   \textcolor{comment}{// Convert to enum.}
00431   \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdf}{Unit::ImpedanceUnit} impedanceUnit;
00432 
00433   \textcolor{keywordflow}{switch} (ImpUn) \{
00434   \textcolor{keywordflow}{case} 1:
00435     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa6b9c74d1763eefbaf751eeecff0bd9da}{Unit::kOhm};
00436     \textcolor{keywordflow}{break};
00437 
00438   \textcolor{keywordflow}{case} 2:
00439     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa35e9ca44deb5a35fdb576111cf0db336}{Unit::kOhmPerMeter};
00440     \textcolor{keywordflow}{break};
00441 
00442   \textcolor{keywordflow}{case} 3:
00443     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa56a0289d2ddeff7ca4aa8ba410df79d6}{Unit::kOhmPerKilometer};
00444     \textcolor{keywordflow}{break};
00445 
00446   \textcolor{keywordflow}{case} 4:
00447     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa433b57934ca3be960ec7a60f3ea6ea87}{Unit::kOhmPerFeet};
00448     \textcolor{keywordflow}{break};
00449 
00450   \textcolor{keywordflow}{case} 5:
00451     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa1d5bb04c9ecda66b09891af21cd4f613}{Unit::kOhmPerMile};
00452     \textcolor{keywordflow}{break};
00453 
00454   \textcolor{keywordflow}{default}:
00455     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa6b9c74d1763eefbaf751eeecff0bd9da}{Unit::kOhm};
00456     \textcolor{keywordflow}{break};
00457   \}
00458 
00459   \textcolor{comment}{// Get power Unit.}
00460   int32\_t powerUn;
00461   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"Demanda"}, &powerUn);
00462 
00463   \textcolor{keywordflow}{if}(processedLines == -1) \{
00464     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00465                           \textcolor{stringliteral}{"The file "} + fileName +
00466                           \textcolor{stringliteral}{" doesn't provide Power Init."},
00467                           QMessageBox::Ok);
00468     file.close();
00469     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00470   \}
00471 
00472   lineCnt += processedLines;
00473 
00474   \textcolor{comment}{// Convert to enum.}
00475   \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3b}{Unit::PowerUnit} powerUnit;
00476 
00477   \textcolor{keywordflow}{switch} (powerUn) \{
00478   \textcolor{keywordflow}{case} 1:
00479     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba72b181a842ae2759488a2fa1410d3696}{Unit::kVA};
00480     \textcolor{keywordflow}{break};
00481 
00482   \textcolor{keywordflow}{case} 2:
00483     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA};
00484     \textcolor{keywordflow}{break};
00485 
00486   \textcolor{keywordflow}{case} 3:
00487     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba6039da0ed20f8bee64305bab8bdec365}{Unit::kMegaVa};
00488     \textcolor{keywordflow}{break};
00489 
00490   \textcolor{keywordflow}{default}:
00491     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA};
00492     \textcolor{keywordflow}{break};
00493   \}
00494 
00495   \textcolor{comment}{// Get Bars.}
00496   QString lineTxt;
00497 
00498   \textcolor{keywordflow}{do} \{
00499     lineTxt = stream.readLine();
00500     lineCnt++;
00501 
00502     \textcolor{keywordflow}{if}(stream.atEnd()) \{
00503       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00504                             \textcolor{stringliteral}{"The file "} + fileName + \textcolor{stringliteral}{" doesn't provide bars."},
00505                             QMessageBox::Ok);
00506       file.close();
00507       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00508     \}
00509   \} \textcolor{keywordflow}{while}(!lineTxt.contains(\textcolor{stringliteral}{"Barra"}));
00510 
00511   int32\_t id;
00512   int32\_t barType;
00513   \textcolor{keywordtype}{double} Sia, Siai;
00514   \textcolor{keywordtype}{double} Sib, Sibi;
00515   \textcolor{keywordtype}{double} Sic, Sici;
00516   \textcolor{keywordtype}{double} Sha, Shai;
00517   \textcolor{keywordtype}{double} Shb, Shbi;
00518   \textcolor{keywordtype}{double} Shc, Shci;
00519 
00520   int32\_t idBase = 0;
00521 
00522   \hyperlink{class_bar}{Bar} *bar;
00523 
00524   \textcolor{keywordflow}{for}(int32\_t i=0; i<numBar; i++) \{
00525     stream >> \textcolor{keywordtype}{id} >> barType >> Sia >> Siai >> Sib >> Sibi >> Sic >> Sici;
00526     stream >> Sha >> Shai >> Shb >> Shbi >> Shc >>Shci;
00527 
00528     \textcolor{keywordflow}{if}(barType == 3)
00529       idBase = id;
00530 
00531     bar = \textcolor{keyword}{new} \hyperlink{class_bar}{Bar};
00532     bar->\hyperlink{class_bar_a9dc5c6a6d44fe412ae34ef8a881b8dce}{id} = \textcolor{keywordtype}{id} - idBase;
00533 
00534     bar->\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{setSh}(0, complex<double>(Sha, Shai), powerUnit);
00535     bar->\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{setSh}(1, complex<double>(Shb, Shbi), powerUnit);
00536     bar->\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{setSh}(2, complex<double>(Shc, Shci), powerUnit);
00537 
00538     bar->\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{setSi}(0, complex<double>(Sia, Siai), powerUnit);
00539     bar->\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{setSi}(1, complex<double>(Sib, Sibi), powerUnit);
00540     bar->\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{setSi}(2, complex<double>(Sic, Sici), powerUnit);
00541 
00542     \textcolor{keywordflow}{if} (!network->\hyperlink{group___graphics_ga8c5dfef0216731246f7411e1a5fbee01}{addBar}(bar)) \{
00543       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid Bar."},
00544                             \textcolor{stringliteral}{"Invalid Bar "} + QString::number(\textcolor{keywordtype}{id}) + \textcolor{stringliteral}{"at line "} +
00545                             QString::number(lineCnt) + \textcolor{stringliteral}{"."},
00546                             QMessageBox::Ok);
00547       \textcolor{keyword}{delete} bar;
00548       file.close();
00549       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00550     \}
00551 
00552     \textcolor{comment}{// Set Initial voltage to 1pu.}
00553     bar->\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{setV}(0, std::polar(network->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase}, 0.0));
00554     bar->\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{setV}(1, std::polar(network->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase}, 0.0));
00555     bar->\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{setV}(2, std::polar(network->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase}, 0.0));
00556 
00557     lineTxt = stream.readLine();
00558     lineCnt++;
00559   \}
00560 
00561   \textcolor{comment}{// Get Lines.}
00562   \textcolor{keywordflow}{do} \{
00563     \textcolor{keywordflow}{if}(stream.atEnd()) \{
00564       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00565                             \textcolor{stringliteral}{"The file "} + fileName + \textcolor{stringliteral}{" doesn't provide lines."},
00566                             QMessageBox::Ok);
00567       file.close();
00568       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00569     \}
00570 
00571     lineTxt = stream.readLine();
00572     lineCnt++;
00573   \} \textcolor{keywordflow}{while}(!lineTxt.contains(\textcolor{stringliteral}{"Tipo\_Cir"}));
00574 
00575   int32\_t noI, noF;
00576   \textcolor{keywordtype}{double} Zaa, Zaai;
00577   \textcolor{keywordtype}{double} Zab, Zabi;
00578   \textcolor{keywordtype}{double} Zac, Zaci;
00579   \textcolor{keywordtype}{double} Zbb, Zbbi;
00580   \textcolor{keywordtype}{double} Zbc, Zbci;
00581   \textcolor{keywordtype}{double} Zcc, Zcci;
00582   \textcolor{keywordtype}{double} length;
00583   QString lineType;
00584   QString dummy;
00585 
00586   \hyperlink{class_line}{Line} *line;
00587 
00588   \textcolor{keywordflow}{for}(int32\_t i=0; i<numLine; i++) \{
00589     line = \textcolor{keyword}{new} \hyperlink{class_line}{Line};
00590     stream >> lineType >> noI >> noF;
00591     line->\hyperlink{class_line_afd17c40d656e6a8d677cb22df5f0c70b}{nodes}.first = noI - idBase;
00592     line->\hyperlink{class_line_afd17c40d656e6a8d677cb22df5f0c70b}{nodes}.second = noF - idBase;
00593 
00594     \textcolor{keywordflow}{if} (lineType.contains(\textcolor{stringliteral}{"CP"})) \{
00595       stream >> Zaa >> Zaai >> Zbb >> Zbbi >> Zcc;
00596       stream >> Zcci >> dummy >> dummy >> Zab >> Zabi >> Zac >> Zaci >> dummy;
00597       stream >> dummy >> Zbc >> Zbci >> dummy >> dummy >> dummy >> dummy;
00598       stream >> dummy >> length;
00599 
00600       line->\hyperlink{group___models_ga950d0b8f5d167eda430c65ca7adadbb0}{setLength}(length, lengthUnit);
00601 
00602       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(0, complex<double>(Zaa, Zaai), impedanceUnit);
00603       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(1, complex<double>(Zab, Zabi), impedanceUnit);
00604       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(2, complex<double>(Zac, Zaci), impedanceUnit);
00605       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(3, complex<double>(Zbb, Zbbi), impedanceUnit);
00606       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(4, complex<double>(Zbc, Zbci), impedanceUnit);
00607       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(5, complex<double>(Zcc, Zcci), impedanceUnit);
00608     \}
00609 
00610     \textcolor{keywordflow}{if} (!network->\hyperlink{group___graphics_gae02945131494987b3ff9b59b627719b4}{addLine}(line)) \{
00611       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid Line."},
00612                             \textcolor{stringliteral}{"Invalid Line at line "} +
00613                             QString::number(lineCnt) + \textcolor{stringliteral}{"."},
00614                             QMessageBox::Ok);
00615       \textcolor{keyword}{delete} line;
00616       file.close();
00617       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00618     \}
00619 
00620     lineTxt = stream.readLine();
00621     lineCnt++;
00622   \}
00623 
00624   \hyperlink{class_redraw_network}{RedrawNetwork} redraw(network);
00625   redraw.\hyperlink{class_redraw_network_a94d53ddf8ee00c4ef6d56bb988333103}{sugiyamaFast}();
00626 
00627   file.close();
00628   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
00629 \}
00630 
\hypertarget{import_8cpp_source_l00631}{}\hyperlink{import_8h_acd1a54d4b2a28043b1489f0be7423ecd}{00631} \textcolor{keywordtype}{bool} \hyperlink{import_8cpp_acd1a54d4b2a28043b1489f0be7423ecd}{importTxtType3}(QString &fileName, \hyperlink{class_network}{Network} *network)
00632 \{
00633   QFile file(fileName);
00634 
00635   \textcolor{keywordflow}{if}(!file.open(QFile::ReadOnly)) \{
00636     QMessageBox::critical(NULL, \textcolor{stringliteral}{"File read error."},
00637                           \textcolor{stringliteral}{"Can\(\backslash\)'t read "} + file.fileName() + \textcolor{stringliteral}{"."},
00638                           QMessageBox::Ok);
00639     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00640   \}
00641 
00642   \textcolor{comment}{// Auxiliaty variables.}
00643   QTextStream stream(&file); \textcolor{comment}{// Text stream used to parse lines.}
00644   int32\_t lineCnt = 0; \textcolor{comment}{// Current line counter, used to report errors.}
00645   int32\_t processedLines = 0; \textcolor{comment}{// Number of lines parsed during get methods.}
00646 
00647   \textcolor{comment}{// Read Number of bars.}
00648   int32\_t numBar;
00649   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"Numero\_barras"}, &numBar);
00650 
00651   \textcolor{keywordflow}{if}(processedLines == -1) \{
00652     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00653                           \textcolor{stringliteral}{"The file "} + fileName +
00654                           \textcolor{stringliteral}{" doesn't provide Numero\_barras."},
00655                           QMessageBox::Ok);
00656     file.close();
00657     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00658   \}
00659 
00660   lineCnt += processedLines;
00661 
00662   \textcolor{comment}{// Read Number of lines.}
00663   int32\_t numLine;
00664   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"Numero\_linhas"}, &numLine);
00665 
00666   \textcolor{keywordflow}{if}(processedLines == -1) \{
00667     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00668                           \textcolor{stringliteral}{"The file "} + fileName +
00669                           \textcolor{stringliteral}{" doesn't provide Numero\_linhas."},
00670                           QMessageBox::Ok);
00671     file.close();
00672     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00673   \}
00674 
00675   lineCnt += processedLines;
00676 
00677   \textcolor{comment}{// Get Length Unit.}
00678   int32\_t LenUn;
00679   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"comprimento\_das\_linhas"}, &LenUn);
00680 
00681   \textcolor{keywordflow}{if}(processedLines == -1) \{
00682     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00683                           \textcolor{stringliteral}{"The file "} + fileName +
00684                           \textcolor{stringliteral}{" doesn't provide Length Unit."},
00685                           QMessageBox::Ok);
00686     file.close();
00687     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00688   \}
00689 
00690   lineCnt += processedLines;
00691 
00692   \textcolor{comment}{// Cast to Unit enum.}
00693   \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0}{Unit::LengthUnit} lengthUnit;
00694 
00695   \textcolor{keywordflow}{switch} (LenUn) \{
00696   \textcolor{keywordflow}{case} 1:
00697     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0abfa41ebe7ee649a1f02c9b8ae570434b}{Unit::kMeter};
00698     \textcolor{keywordflow}{break};
00699 
00700   \textcolor{keywordflow}{case} 2:
00701     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0a1c04f3dd196dbe1832a2658215b0d919}{Unit::kKiloMeter};
00702     \textcolor{keywordflow}{break};
00703 
00704   \textcolor{keywordflow}{case} 3:
00705     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0a9ac9b167b0ebce477fb53d6ace04ddc8}{Unit::kFeet};
00706     \textcolor{keywordflow}{break};
00707 
00708   \textcolor{keywordflow}{case} 4:
00709     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0a2ebde742068bbee0510de32fbb4cd724}{Unit::kMile};
00710     \textcolor{keywordflow}{break};
00711 
00712   \textcolor{keywordflow}{default}:
00713     lengthUnit = \hyperlink{class_unit_a8c8921f7b225ad6063b1cb573425b9a0abfa41ebe7ee649a1f02c9b8ae570434b}{Unit::kMeter};
00714     \textcolor{keywordflow}{break};
00715   \}
00716 
00717   \textcolor{comment}{// Get Impedance Unit.}
00718   int32\_t ImpUn;
00719   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"impedancia"}, &ImpUn);
00720 
00721   \textcolor{keywordflow}{if}(processedLines == -1) \{
00722     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00723                           \textcolor{stringliteral}{"The file "} + fileName +
00724                           \textcolor{stringliteral}{" doesn't provide Impedance Unit."},
00725                           QMessageBox::Ok);
00726     file.close();
00727     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00728   \}
00729 
00730   lineCnt += processedLines;
00731 
00732   \textcolor{comment}{// Convert to enum.}
00733   \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdf}{Unit::ImpedanceUnit} impedanceUnit;
00734 
00735   \textcolor{keywordflow}{switch} (ImpUn) \{
00736   \textcolor{keywordflow}{case} 1:
00737     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa6b9c74d1763eefbaf751eeecff0bd9da}{Unit::kOhm};
00738     \textcolor{keywordflow}{break};
00739 
00740   \textcolor{keywordflow}{case} 2:
00741     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa35e9ca44deb5a35fdb576111cf0db336}{Unit::kOhmPerMeter};
00742     \textcolor{keywordflow}{break};
00743 
00744   \textcolor{keywordflow}{case} 3:
00745     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa56a0289d2ddeff7ca4aa8ba410df79d6}{Unit::kOhmPerKilometer};
00746     \textcolor{keywordflow}{break};
00747 
00748   \textcolor{keywordflow}{case} 4:
00749     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa433b57934ca3be960ec7a60f3ea6ea87}{Unit::kOhmPerFeet};
00750     \textcolor{keywordflow}{break};
00751 
00752   \textcolor{keywordflow}{case} 5:
00753     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa1d5bb04c9ecda66b09891af21cd4f613}{Unit::kOhmPerMile};
00754     \textcolor{keywordflow}{break};
00755 
00756   \textcolor{keywordflow}{default}:
00757     impedanceUnit = \hyperlink{class_unit_a3747e779c805df24a71961290be3fbdfa6b9c74d1763eefbaf751eeecff0bd9da}{Unit::kOhm};
00758     \textcolor{keywordflow}{break};
00759   \}
00760 
00761   \textcolor{comment}{// Get power Unit.}
00762   int32\_t powerUn;
00763   processedLines = getNextLineInt(&stream, \textcolor{stringliteral}{"Demanda"}, &powerUn);
00764 
00765   \textcolor{keywordflow}{if}(processedLines == -1) \{
00766     QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00767                           \textcolor{stringliteral}{"The file "} + fileName +
00768                           \textcolor{stringliteral}{" doesn't provide Power Init."},
00769                           QMessageBox::Ok);
00770     file.close();
00771     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00772   \}
00773 
00774   lineCnt += processedLines;
00775 
00776   \textcolor{comment}{// Convert to enum.}
00777   \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3b}{Unit::PowerUnit} powerUnit;
00778 
00779   \textcolor{keywordflow}{switch} (powerUn) \{
00780   \textcolor{keywordflow}{case} 1:
00781     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba72b181a842ae2759488a2fa1410d3696}{Unit::kVA};
00782     \textcolor{keywordflow}{break};
00783 
00784   \textcolor{keywordflow}{case} 2:
00785     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA};
00786     \textcolor{keywordflow}{break};
00787 
00788   \textcolor{keywordflow}{case} 3:
00789     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3ba6039da0ed20f8bee64305bab8bdec365}{Unit::kMegaVa};
00790     \textcolor{keywordflow}{break};
00791 
00792   \textcolor{keywordflow}{default}:
00793     powerUnit = \hyperlink{class_unit_ace265ae255370ccacfd5370337572c3bac9e5154522fbb810d7aed75c3ff47cb2}{Unit::kKiloVA};
00794     \textcolor{keywordflow}{break};
00795   \}
00796 
00797   \textcolor{comment}{// Get Bars.}
00798   QString lineTxt;
00799 
00800   \textcolor{keywordflow}{do} \{
00801     lineTxt = stream.readLine();
00802     lineCnt++;
00803 
00804     \textcolor{keywordflow}{if}(stream.atEnd()) \{
00805       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00806                             \textcolor{stringliteral}{"The file "} + fileName + \textcolor{stringliteral}{" doesn't provide bars."},
00807                             QMessageBox::Ok);
00808       file.close();
00809       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00810     \}
00811   \} \textcolor{keywordflow}{while}(!lineTxt.contains(\textcolor{stringliteral}{"Barra"}));
00812 
00813   int32\_t id;
00814   int32\_t barType;
00815   \textcolor{keywordtype}{double} Sia, Siai;
00816   \textcolor{keywordtype}{double} Sib, Sibi;
00817   \textcolor{keywordtype}{double} Sic, Sici;
00818   \textcolor{keywordtype}{double} Sha, Shai;
00819   \textcolor{keywordtype}{double} Shb, Shbi;
00820   \textcolor{keywordtype}{double} Shc, Shci;
00821 
00822   int32\_t idBase = 0;
00823 
00824   \hyperlink{class_bar}{Bar} *bar;
00825 
00826   \textcolor{keywordflow}{for}(int32\_t i=0; i<numBar; i++) \{
00827     stream >> \textcolor{keywordtype}{id} >> barType >> Sia >> Siai >> Sib >> Sibi >> Sic >> Sici;
00828     stream >> Sha >> Shai >> Shb >> Shbi >> Shc >>Shci;
00829 
00830     \textcolor{keywordflow}{if}(barType == 3)
00831       idBase = id;
00832 
00833     bar = \textcolor{keyword}{new} \hyperlink{class_bar}{Bar};
00834     bar->\hyperlink{class_bar_a9dc5c6a6d44fe412ae34ef8a881b8dce}{id} = \textcolor{keywordtype}{id} - idBase;
00835 
00836     bar->\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{setSh}(0, complex<double>(Sha, Shai), powerUnit);
00837     bar->\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{setSh}(1, complex<double>(Shb, Shbi), powerUnit);
00838     bar->\hyperlink{group___models_ga207abd3d0649a488e3c44cf2a501ed23}{setSh}(2, complex<double>(Shc, Shci), powerUnit);
00839 
00840     bar->\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{setSi}(0, complex<double>(Sia, Siai), powerUnit);
00841     bar->\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{setSi}(1, complex<double>(Sib, Sibi), powerUnit);
00842     bar->\hyperlink{group___models_ga74e510be49e50e4c14550b32e1dc92f9}{setSi}(2, complex<double>(Sic, Sici), powerUnit);
00843 
00844 
00845     \textcolor{keywordflow}{if} (!network->\hyperlink{group___graphics_ga8c5dfef0216731246f7411e1a5fbee01}{addBar}(bar)) \{
00846       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid Bar."},
00847                             \textcolor{stringliteral}{"Invalid Bar "} + QString::number(\textcolor{keywordtype}{id}) + \textcolor{stringliteral}{"at line "} +
00848                             QString::number(lineCnt) + \textcolor{stringliteral}{"."},
00849                             QMessageBox::Ok);
00850       \textcolor{keyword}{delete} bar;
00851       file.close();
00852       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00853     \}
00854 
00855     \textcolor{comment}{// Set Initial voltage to 1pu.}
00856     bar->\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{setV}(0, std::polar(network->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase}, 0.0));
00857     bar->\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{setV}(1, std::polar(network->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase}, 0.0));
00858     bar->\hyperlink{group___models_ga9b6fbc92674bfcdc9d5090795ab335a6}{setV}(2, std::polar(network->\hyperlink{group___graphics_ga7c1e79d9ac69df9a69f24eaf092fd5e5}{voltageBase}, 0.0));
00859 
00860     lineTxt = stream.readLine();
00861     lineCnt++;
00862   \}
00863 
00864   \textcolor{comment}{// Get Lines.}
00865   \textcolor{keywordflow}{do} \{
00866     \textcolor{keywordflow}{if}(stream.atEnd()) \{
00867       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid File."},
00868                             \textcolor{stringliteral}{"The file "} + fileName + \textcolor{stringliteral}{" doesn't provide lines."},
00869                             QMessageBox::Ok);
00870       file.close();
00871       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00872     \}
00873 
00874     lineTxt = stream.readLine();
00875     lineCnt++;
00876   \} \textcolor{keywordflow}{while}(!lineTxt.contains(\textcolor{stringliteral}{"Tipo\_Cir"}));
00877 
00878   int32\_t noI, noF;
00879   \textcolor{keywordtype}{double} Zaa, Zaai;
00880   \textcolor{keywordtype}{double} Zab, Zabi;
00881   \textcolor{keywordtype}{double} Zac, Zaci;
00882   \textcolor{keywordtype}{double} Zbb, Zbbi;
00883   \textcolor{keywordtype}{double} Zbc, Zbci;
00884   \textcolor{keywordtype}{double} Zcc, Zcci;
00885   \textcolor{keywordtype}{double} length;
00886   QString lineType;
00887   QString dummy;
00888 
00889   \hyperlink{class_line}{Line} *line;
00890 
00891   \textcolor{keywordflow}{for}(int32\_t i=0; i<numLine; i++) \{
00892     line = \textcolor{keyword}{new} \hyperlink{class_line}{Line};
00893     stream >> lineType >> noI >> noF;
00894     line->\hyperlink{class_line_afd17c40d656e6a8d677cb22df5f0c70b}{nodes}.first = noI - idBase;
00895     line->\hyperlink{class_line_afd17c40d656e6a8d677cb22df5f0c70b}{nodes}.second = noF - idBase;
00896 
00897     \textcolor{keywordflow}{if} (lineType.contains(\textcolor{stringliteral}{"CP"})) \{
00898       stream >> dummy >> dummy >> dummy >> dummy >> Zaa >> Zaai >> Zbb >> Zbbi;
00899       stream >> Zcc >> Zcci >> dummy >> dummy >> Zab >> Zabi >> Zac >> Zaci;
00900       stream >> dummy >> dummy >> Zbc >> Zbci >> dummy >> dummy >> dummy;
00901       stream >> dummy >> dummy >> length;
00902 
00903       line->\hyperlink{group___models_ga950d0b8f5d167eda430c65ca7adadbb0}{setLength}(length, lengthUnit);
00904 
00905       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(0, complex<double>(Zaa, Zaai), impedanceUnit);
00906       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(1, complex<double>(Zab, Zabi), impedanceUnit);
00907       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(2, complex<double>(Zac, Zaci), impedanceUnit);
00908       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(3, complex<double>(Zbb, Zbbi), impedanceUnit);
00909       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(4, complex<double>(Zbc, Zbci), impedanceUnit);
00910       line->\hyperlink{group___models_ga409df7d11f5c5d594a13fb2f74b3b9e0}{setZ}(5, complex<double>(Zcc, Zcci), impedanceUnit);
00911     \}
00912 
00913     \textcolor{keywordflow}{if} (!network->\hyperlink{group___graphics_gae02945131494987b3ff9b59b627719b4}{addLine}(line)) \{
00914       QMessageBox::critical(NULL, \textcolor{stringliteral}{"Invalid Line."},
00915                             \textcolor{stringliteral}{"Invalid Line at line "} +
00916                             QString::number(lineCnt) + \textcolor{stringliteral}{"."},
00917                             QMessageBox::Ok);
00918       \textcolor{keyword}{delete} line;
00919       file.close();
00920       \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00921     \}
00922 
00923     lineTxt = stream.readLine();
00924     lineCnt++;
00925   \}
00926 
00927   \hyperlink{class_redraw_network}{RedrawNetwork} redraw(network);
00928   redraw.\hyperlink{class_redraw_network_a94d53ddf8ee00c4ef6d56bb988333103}{sugiyamaFast}();
00929 
00930   file.close();
00931   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
00932 \}
\end{DoxyCode}
