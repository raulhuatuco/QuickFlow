\hypertarget{quickflow_8cpp_source}{}\subsection{quickflow.\+cpp}
\label{quickflow_8cpp_source}\index{quickflow.\+cpp@{quickflow.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{/*}
00002 \textcolor{comment}{ * The MIT License (MIT)}
00003 \textcolor{comment}{ *}
00004 \textcolor{comment}{ * Copyright (c) 2015 David Krepsky}
00005 \textcolor{comment}{ *}
00006 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}
00007 \textcolor{comment}{ * of this software and associated documentation files (the "Software"), to deal}
00008 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}
00009 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}
00010 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}
00011 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}
00012 \textcolor{comment}{ *}
00013 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in}
00014 \textcolor{comment}{ * all copies or substantial portions of the Software.}
00015 \textcolor{comment}{ *}
00016 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}
00017 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}
00018 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}
00019 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}
00020 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}
00021 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}
00022 \textcolor{comment}{ * SOFTWARE.}
00023 \textcolor{comment}{ */}
00024 
00043 \textcolor{preprocessor}{#include "\hyperlink{quickflow_8h}{quickflow.h}"}
00044 \textcolor{preprocessor}{#include "ui\_quickflow.h"}
00045 
00046 
00047 \textcolor{preprocessor}{#include "\hyperlink{projectproperties_8h}{window/projectproperties.h}"}
00048 \textcolor{preprocessor}{#include "\hyperlink{networkproperties_8h}{window/networkproperties.h}"}
00049 \textcolor{preprocessor}{#include "\hyperlink{barproperties_8h}{window/barproperties.h}"}
00050 \textcolor{preprocessor}{#include "\hyperlink{lineproperties_8h}{window/lineproperties.h}"}
00051 \textcolor{preprocessor}{#include "\hyperlink{about_8h}{window/about.h}"}
00052 \textcolor{preprocessor}{#include "\hyperlink{searchbar_8h}{window/searchbar.h}"}
00053 
00054 \textcolor{preprocessor}{#include "\hyperlink{bar_8h}{models/bar.h}"}
00055 \textcolor{preprocessor}{#include "\hyperlink{line_8h}{models/line.h}"}
00056 \textcolor{preprocessor}{#include "\hyperlink{network_8h}{models/network.h}"}
00057 
00058 \textcolor{preprocessor}{#include "\hyperlink{import_8h}{algorithms/import.h}"}
00059 \textcolor{preprocessor}{#include "\hyperlink{redrawnetwork_8h}{algorithms/redrawnetwork.h}"}
00060 \textcolor{preprocessor}{#include "\hyperlink{shirmoharmmadi_8h}{algorithms/shirmoharmmadi.h}"}
00061 \textcolor{preprocessor}{#include "\hyperlink{cespedes_8h}{algorithms/cespedes.h}"}
00062 
00063 \textcolor{comment}{/*****************************************************************************}
00064 \textcolor{comment}{* Const.}
00065 \textcolor{comment}{*****************************************************************************/}
00066 \textcolor{keyword}{const} QString \hyperlink{group___window_gabfc3b1280bdae9a9c046d56b1459ab99}{QuickFlow::kVersion} = \textcolor{stringliteral}{"0.0.5"};
00067 
00068 \textcolor{comment}{/*******************************************************************************}
00069 \textcolor{comment}{ * Constructor.}
00070 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{quickflow_8cpp_source_l00071}{}\hyperlink{group___window_ga7689e2608835392fce3f4c95a7a542db}{00071} \hyperlink{group___window_ga7689e2608835392fce3f4c95a7a542db}{QuickFlow::QuickFlow}(QWidget *parent)
00072   : QMainWindow(parent),
00073     ui(new \hyperlink{namespace_ui}{Ui}::\hyperlink{class_quick_flow}{QuickFlow}),
00074     project(NULL),
00075     altered\_ (false)
00076 \{
00077   \textcolor{comment}{// Set-up user interface.}
00078   ui->setupUi(\textcolor{keyword}{this});
00079 
00080   \textcolor{comment}{// Adjust initial interface to disable project related actions.}
00081   noProjectInterface();
00082 
00083   \textcolor{comment}{// Set application info.}
00084   QCoreApplication::setOrganizationName(\textcolor{stringliteral}{"DKrepsky"});
00085   QCoreApplication::setOrganizationDomain(\textcolor{stringliteral}{"dkrepsky.blogspot.com.br"});
00086   QCoreApplication::setApplicationName(\textcolor{stringliteral}{"QuickFlow"});
00087   QCoreApplication::setApplicationVersion(\hyperlink{group___window_gabfc3b1280bdae9a9c046d56b1459ab99}{kVersion});
00088 
00089   \textcolor{comment}{// Check for settings existence and version.}
00090   settings = \textcolor{keyword}{new} QSettings(\textcolor{keyword}{this});
00091 
00092   \textcolor{keywordflow}{if} (settings->contains(\textcolor{stringliteral}{"version"})) \{
00093     \textcolor{keywordflow}{if} (settings->value(\textcolor{stringliteral}{"version"}).toString() == \hyperlink{group___window_gabfc3b1280bdae9a9c046d56b1459ab99}{kVersion})
00094       \textcolor{comment}{// If exists and is in the current version, use it.}
00095       loadSettings();
00096     \textcolor{keywordflow}{else}
00097       \textcolor{comment}{// Update to the new program version.}
00098       upgradeSettings();
00099   \} \textcolor{keywordflow}{else} \{
00100     \textcolor{comment}{// If there is no settings availiable, create a new one with default values.}
00101     createSettings();
00102   \}
00103 
00104   connectSignals();
00105 \}
00106 
00107 \textcolor{comment}{/*******************************************************************************}
00108 \textcolor{comment}{ * Destructor.}
00109 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{quickflow_8cpp_source_l00110}{}\hyperlink{group___window_ga985823a0db64246b3a15eed2f397e0a4}{00110} \hyperlink{group___window_ga985823a0db64246b3a15eed2f397e0a4}{QuickFlow::~QuickFlow}()
00111 \{
00112   disconnectSignals();
00113   \textcolor{keyword}{delete} ui;
00114 \}
00115 
00116 \textcolor{comment}{/*******************************************************************************}
00117 \textcolor{comment}{ * Is altered.}
00118 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{quickflow_8cpp_source_l00119}{}\hyperlink{group___window_ga5d9148467ef65c48419bf020ee107a45}{00119} \textcolor{keywordtype}{bool} \hyperlink{group___window_ga5d9148467ef65c48419bf020ee107a45}{QuickFlow::isAltered}()
00120 \{
00121   \textcolor{keywordflow}{return} altered\_;
00122 \}
00123 
00124 \textcolor{comment}{/*******************************************************************************}
00125 \textcolor{comment}{ * Set altered.}
00126 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{quickflow_8cpp_source_l00127}{}\hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{00127} \textcolor{keywordtype}{void} \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{QuickFlow::setAltered}(\textcolor{keywordtype}{bool} altered)
00128 \{
00129   altered\_ = altered;
00130 
00131   \textcolor{keywordflow}{if}(altered\_) \{
00132     ui->actionSave->setEnabled(\textcolor{keyword}{true});
00133     \textcolor{comment}{// Change window title to indicate that the project is altered.}
00134     setWindowTitle(\textcolor{stringliteral}{"QkFlow - *"} + project->\hyperlink{class_project_a82dd2d1bc38f9fd08c9a811fcaa76b38}{name});
00135   \} \textcolor{keywordflow}{else} \{
00136     ui->actionSave->setEnabled(\textcolor{keyword}{false});
00137     \textcolor{comment}{// Change window title to indicate that the project has been saved.}
00138     setWindowTitle(\textcolor{stringliteral}{"QkFlow - "} + project->\hyperlink{class_project_a82dd2d1bc38f9fd08c9a811fcaa76b38}{name});
00139   \}
00140 \}
00141 
00142 \textcolor{comment}{/*******************************************************************************}
00143 \textcolor{comment}{ * Zoom in action.}
00144 \textcolor{comment}{ ******************************************************************************/}
00145 \textcolor{keywordtype}{void} QuickFlow::on\_actionZoomIn\_triggered()
00146 \{
00147   ui->systemView->zoomIn();
00148 \}
00149 
00150 \textcolor{comment}{/*******************************************************************************}
00151 \textcolor{comment}{ * Zoom out action.}
00152 \textcolor{comment}{ ******************************************************************************/}
00153 \textcolor{keywordtype}{void} QuickFlow::on\_actionZoomOut\_triggered()
00154 \{
00155   ui->systemView->zoomOut();
00156 \}
00157 
00158 \textcolor{comment}{/*******************************************************************************}
00159 \textcolor{comment}{ * Zoom fit action.}
00160 \textcolor{comment}{ ******************************************************************************/}
00161 \textcolor{keywordtype}{void} QuickFlow::on\_actionZoomFit\_triggered()
00162 \{
00163   ui->systemView->scene()->update();
00164   ui->systemView->zoomFit();
00165 \}
00166 
00167 \textcolor{comment}{/*******************************************************************************}
00168 \textcolor{comment}{ * Exit action.}
00169 \textcolor{comment}{ ******************************************************************************/}
00170 \textcolor{keywordtype}{void} QuickFlow::on\_actionExit\_triggered()
00171 \{
00172   close();
00173 \}
00174 
00175 \textcolor{comment}{/*******************************************************************************}
00176 \textcolor{comment}{ * New project action.}
00177 \textcolor{comment}{ ******************************************************************************/}
00178 \textcolor{keywordtype}{void} QuickFlow::on\_actionNew\_triggered()
00179 \{
00180   \textcolor{comment}{// Check if there is a project already opened.}
00181   \textcolor{keywordflow}{if} (project != NULL) \{
00182     \textcolor{comment}{// Close project}
00183     ui->actionClose->trigger();
00184 
00185     \textcolor{comment}{// If close didnt succed, cancel new project.}
00186     \textcolor{keywordflow}{if} (project != NULL) \textcolor{keywordflow}{return};
00187   \}
00188 
00189   \hyperlink{class_project_properties}{ProjectProperties} projectProperties(\textcolor{keyword}{this});
00190   projectProperties.setOptions(NULL);
00191 
00192   \textcolor{comment}{// If canceled return}
00193   \textcolor{keywordflow}{if} (projectProperties.exec() != QDialog::Accepted) \{
00194     \textcolor{keywordflow}{return};
00195   \}
00196 
00197   \textcolor{comment}{// Save project pointer}
00198   project = projectProperties.project();
00199 
00200   \textcolor{comment}{// New project is Ok}
00201   \textcolor{comment}{// Change window title to indicate that the project is open}
00202   setWindowTitle(\textcolor{stringliteral}{"QkFlow - "} + project->\hyperlink{class_project_a82dd2d1bc38f9fd08c9a811fcaa76b38}{name});
00203   \textcolor{comment}{// Enable interface}
00204   workInterface();
00205 \}
00206 
00207 \textcolor{comment}{/*******************************************************************************}
00208 \textcolor{comment}{ * Open project action.}
00209 \textcolor{comment}{ ******************************************************************************/}
00210 \textcolor{keywordtype}{void} QuickFlow::on\_actionOpen\_triggered()
00211 \{
00212   \textcolor{comment}{// Check if there is a project already opened.}
00213   \textcolor{keywordflow}{if} (project != NULL) \{
00214     \textcolor{comment}{// Close project.}
00215     ui->actionClose->trigger();
00216 
00217     \textcolor{comment}{// If close didnt succed, cancel new project.}
00218     \textcolor{keywordflow}{if} (project != NULL) \textcolor{keywordflow}{return};
00219   \}
00220 
00221   \textcolor{comment}{// Open file dialog to select the project file.}
00222   QFileDialog projectFile(\textcolor{keyword}{this});
00223   projectFile.setFileMode(QFileDialog::ExistingFile);
00224   projectFile.setAcceptMode(QFileDialog::AcceptOpen);
00225   projectFile.setNameFilter(tr(\textcolor{stringliteral}{"QuickFlow Project (*.qkf)"}));
00226   QString initialPath = QStandardPaths::standardLocations(
00227                           QStandardPaths::DocumentsLocation)[0] + \textcolor{stringliteral}{"/QuickFlow"};
00228 
00229   projectFile.setDirectory(initialPath);
00230 
00231   \textcolor{comment}{// Check if user has canceled the opening.}
00232   \textcolor{keywordflow}{if} (projectFile.exec() != QDialog::Accepted) \{
00233     \textcolor{keywordflow}{return};
00234   \}
00235 
00236   \textcolor{comment}{// Grab filename.}
00237   QString fileName = projectFile.selectedFiles()[0];
00238 
00239   \textcolor{comment}{// Create project object and load from file.}
00240   project = \textcolor{keyword}{new} \hyperlink{class_project}{Project};
00241   project->\hyperlink{class_project_a79f30adcefd0b72bd4ac7db724bc9531}{filePath} = fileName;
00242 
00243   \textcolor{keywordflow}{if} (project->\hyperlink{class_project_a1e373892a0383371132ce68fa5f8813d}{load}() != \textcolor{keyword}{true}) \{
00244     QMessageBox::critical(\textcolor{keyword}{this}, \textcolor{stringliteral}{"File read error"}, \textcolor{stringliteral}{"Cannot read .qkf file."},
00245                           QMessageBox::Ok);
00246     \textcolor{keyword}{delete} project;
00247     project = NULL;
00248     \textcolor{keywordflow}{return};
00249   \}
00250 
00251   \textcolor{comment}{// New project is Ok.}
00252   \textcolor{comment}{// Change window title to indicate that the project is open.}
00253   setWindowTitle(\textcolor{stringliteral}{"QuickFlow - "} + project->\hyperlink{class_project_a82dd2d1bc38f9fd08c9a811fcaa76b38}{name});
00254   \textcolor{comment}{// Enable interface.}
00255   workInterface();
00256 
00257   \textcolor{comment}{// Add networks}
00258   \textcolor{keywordflow}{foreach}(\hyperlink{class_network}{Network} *network, project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}) \{
00259     ui->systemView->addNetwork(network);
00260   \}
00261 \}
00262 
00263 \textcolor{comment}{/*******************************************************************************}
00264 \textcolor{comment}{ * Save project action.}
00265 \textcolor{comment}{ ******************************************************************************/}
00266 \textcolor{keywordtype}{void} QuickFlow::on\_actionSave\_triggered()
00267 \{
00268   \textcolor{comment}{// Check for alterations}
00269   \textcolor{keywordflow}{if} (altered\_) \{
00270     \textcolor{keywordflow}{if} (project->\hyperlink{class_project_a596a875bc5be73bc5b1b71b6448c1e07}{save}() != \textcolor{keyword}{true}) \{
00271       QMessageBox::critical(\textcolor{keyword}{this}, \textcolor{stringliteral}{"Write to file failed"},
00272                             \textcolor{stringliteral}{"Cannot save project."}, QMessageBox::Ok);
00273       \textcolor{keywordflow}{return};
00274     \}
00275   \}
00276 
00277   \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{false});
00278 \}
00279 
00280 \textcolor{comment}{/*******************************************************************************}
00281 \textcolor{comment}{ * Save project as action.}
00282 \textcolor{comment}{ ******************************************************************************/}
00283 \textcolor{keywordtype}{void} QuickFlow::on\_actionSave\_as\_triggered()
00284 \{
00285   \textcolor{comment}{// Get file location from user.}
00286   QFileDialog projectFile(\textcolor{keyword}{this});
00287   projectFile.setAcceptMode(QFileDialog::AcceptSave);
00288   projectFile.setNameFilter(tr(\textcolor{stringliteral}{"QuickFlow Project (*.qkf)"}));
00289   QString initialPath = QStandardPaths::standardLocations(
00290                           QStandardPaths::DocumentsLocation)[0] + \textcolor{stringliteral}{"/QuickFlow"};
00291   projectFile.setDirectory(initialPath);
00292 
00293   \textcolor{comment}{// Check if user has canceled the opening.}
00294   \textcolor{keywordflow}{if} (projectFile.exec() != QDialog::Accepted) \{
00295     \textcolor{keywordflow}{return};
00296   \}
00297 
00298   \textcolor{comment}{// Grab filename.}
00299   QString filePath = projectFile.selectedFiles()[0];
00300 
00301   \textcolor{comment}{// Try to save.}
00302   \textcolor{keywordflow}{if} (project->\hyperlink{class_project_ad32a31d548ad38f4cbbe0f95879a68e5}{saveAs}(filePath) != \textcolor{keyword}{true}) \{
00303     QMessageBox::critical(\textcolor{keyword}{this}, \textcolor{stringliteral}{"Write to file failed"},
00304                           \textcolor{stringliteral}{"Cannot save project."}, QMessageBox::Ok);
00305     \textcolor{keywordflow}{return};
00306   \}
00307 
00308   \textcolor{comment}{// Adjust Project settings.}
00309   project->\hyperlink{class_project_a79f30adcefd0b72bd4ac7db724bc9531}{filePath} = filePath;
00310 
00311   \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{false});
00312 \}
00313 
00314 \textcolor{comment}{/*******************************************************************************}
00315 \textcolor{comment}{* Close project action.}
00316 \textcolor{comment}{******************************************************************************/}
00317 \textcolor{keywordtype}{void} QuickFlow::on\_actionClose\_triggered()
00318 \{
00319   \textcolor{comment}{// Check if project is open}
00320   \textcolor{keywordflow}{if} (project == NULL) \{
00321     \textcolor{comment}{// Disable interface and return}
00322     noProjectInterface();
00323     \textcolor{keywordflow}{return};
00324   \}
00325 
00326   \textcolor{comment}{// A project is open. Check for alterations and try to save.}
00327   \textcolor{comment}{// Check whether it does need to save the project or not}
00328   \textcolor{keywordflow}{if} (altered\_) \{
00329     \textcolor{comment}{// Ask user to discard changes}
00330     \textcolor{keywordtype}{int} button = QMessageBox::question(
00331                    \textcolor{keyword}{this}, \textcolor{stringliteral}{"Save"}, \textcolor{stringliteral}{"There are unsaved changes, save it?"},
00332                    QMessageBox::Discard | QMessageBox::Cancel | QMessageBox::Save);
00333 
00334     \textcolor{comment}{// User wants to save}
00335     \textcolor{keywordflow}{if} (button == QMessageBox::Save) \{
00336       \textcolor{comment}{// Try to save}
00337       ui->actionSave->trigger();
00338 
00339       \textcolor{comment}{// Check if save is Ok}
00340       \textcolor{keywordflow}{if} (altered\_) \{
00341         \textcolor{comment}{// User canceled}
00342         \textcolor{keywordflow}{return};
00343       \}
00344     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (button == QMessageBox::Cancel) \{
00345       \textcolor{comment}{// User canceled}
00346       \textcolor{keywordflow}{return};
00347     \}
00348   \}
00349 
00350   \textcolor{keywordflow}{foreach}(\hyperlink{class_network}{Network} *network, project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}) \{
00351     ui->systemView->removeNetwork(network);
00352   \}
00353 
00354   ui->systemView->zoomFit();
00355 
00356   \textcolor{keyword}{delete} project;
00357   project = NULL;
00358   altered\_ = \textcolor{keyword}{false};
00359   noProjectInterface();
00360   setWindowTitle(\textcolor{stringliteral}{"QuickFlow"});
00361 \}
00362 
00363 
00364 \textcolor{comment}{/*******************************************************************************}
00365 \textcolor{comment}{* Add network action.}
00366 \textcolor{comment}{******************************************************************************/}
00367 \textcolor{keywordtype}{void} QuickFlow::on\_actionAdd\_Network\_triggered()
00368 \{
00369   \hyperlink{class_network_properties}{NetworkProperties} newNetwork(\textcolor{keyword}{this});
00370   newNetwork.setOptions(project, NULL);
00371 
00372   \textcolor{keywordflow}{if} (newNetwork.exec() == QDialog::Accepted) \{
00373     \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00374   \}
00375 \}
00376 
00377 \textcolor{comment}{/*******************************************************************************}
00378 \textcolor{comment}{ * Add bar action.}
00379 \textcolor{comment}{ ******************************************************************************/}
00380 \textcolor{keywordtype}{void} QuickFlow::on\_actionAddBar\_triggered()
00381 \{
00382   \hyperlink{class_bar_properties}{BarProperties} barProperties(\textcolor{keyword}{this});
00383 
00384   \textcolor{keywordflow}{if}(barProperties.setOptions(project, NULL))
00385     \textcolor{keywordflow}{if} (barProperties.exec() == QDialog::Accepted) \{
00386       \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00387       ui->systemView->addBar(barProperties.bar());
00388     \}
00389 \}
00390 
00391 \textcolor{comment}{/*******************************************************************************}
00392 \textcolor{comment}{ * Add line action.}
00393 \textcolor{comment}{ ******************************************************************************/}
00394 \textcolor{keywordtype}{void} QuickFlow::on\_actionAddLine\_triggered()
00395 \{
00396   \hyperlink{class_line_properties}{LineProperties} lineProperties(\textcolor{keyword}{this});
00397 
00398   \textcolor{keywordflow}{if}(lineProperties.setOptions(project, NULL))
00399     \textcolor{keywordflow}{if} (lineProperties.exec() == QDialog::Accepted) \{
00400       \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00401       ui->systemView->addLine(lineProperties.line());
00402     \}
00403 \}
00404 
00405 \textcolor{comment}{/*******************************************************************************}
00406 \textcolor{comment}{ * Import txt type 1 action.}
00407 \textcolor{comment}{ ******************************************************************************/}
00408 \textcolor{keywordtype}{void} QuickFlow::on\_action\_txt\_type\_1\_triggered()
00409 \{
00410   \textcolor{comment}{// Get file location from user.}
00411   QFileDialog txtFile(\textcolor{keyword}{this});
00412   txtFile.setAcceptMode(QFileDialog::AcceptOpen);
00413   txtFile.setFileMode(QFileDialog::ExistingFile);
00414   txtFile.setNameFilter(tr(\textcolor{stringliteral}{"Text File Type 1(*.txt)"}));
00415   txtFile.setDirectory(QStandardPaths::standardLocations(
00416                          QStandardPaths::HomeLocation)[0]);
00417 
00418   \textcolor{comment}{// Check if user has canceled the opening.}
00419   \textcolor{keywordflow}{if} (txtFile.exec() != QDialog::Accepted) \{
00420     \textcolor{keywordflow}{return};
00421   \}
00422 
00423   \textcolor{comment}{// Grab filename.}
00424   QString fileName = txtFile.selectedFiles()[0];
00425 
00426   \textcolor{comment}{// Check if there is a project already opened.}
00427   \textcolor{keywordflow}{if} (project == NULL) \{
00428     \textcolor{comment}{// Create a new project.}
00429     on\_actionNew\_triggered();
00430 
00431     \textcolor{comment}{// Check if project has been created.}
00432     \textcolor{keywordflow}{if}(project == NULL) \{
00433       \textcolor{comment}{// User canceled, cancel import.}
00434       QMessageBox::critical(\textcolor{keyword}{this}, \textcolor{stringliteral}{"Need a project to import"},
00435                             \textcolor{stringliteral}{"A project is needed in order to import networks."},
00436                             QMessageBox::Ok);
00437       \textcolor{keywordflow}{return};
00438     \}
00439   \}
00440 
00441   \textcolor{comment}{// Try to import network.}
00442   \hyperlink{class_network}{Network} *network = \textcolor{keyword}{new} \hyperlink{class_network}{Network};
00443 
00444   \textcolor{keywordtype}{bool} importOk = \hyperlink{import_8cpp_ab30ac380d5e14f830ebc8eb839fbbdf0}{importTxtType1}(fileName, network);
00445 
00446   \textcolor{comment}{// Impor success.}
00447   \textcolor{keywordflow}{if}(importOk) \{
00448     project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}.insert(network->\hyperlink{class_network_ab6643733a517f930c60b06f5ffd78186}{name}, network);
00449 
00450     \hyperlink{class_network_properties}{NetworkProperties} newNetwork(\textcolor{keyword}{this});
00451     newNetwork.setOptions(project, network);
00452 
00453     \textcolor{keywordflow}{if} (newNetwork.exec() == QDialog::Rejected) \{
00454       project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}.remove(network->\hyperlink{class_network_ab6643733a517f930c60b06f5ffd78186}{name});
00455       \textcolor{keyword}{delete} network;
00456       \textcolor{keywordflow}{return};
00457     \}
00458 
00459     ui->systemView->addNetwork(network);
00460     ui->systemView->zoomFit();
00461     \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00462   \} \textcolor{keywordflow}{else} \{
00463     \textcolor{keyword}{delete} network;
00464     \textcolor{keywordflow}{return};
00465   \}
00466 \}
00467 
00468 \textcolor{comment}{/*******************************************************************************}
00469 \textcolor{comment}{ * Import txt type 2 action.}
00470 \textcolor{comment}{ ******************************************************************************/}
00471 \textcolor{keywordtype}{void} QuickFlow::on\_action\_txt\_type\_2\_triggered()
00472 \{
00473   \textcolor{comment}{// Get file location from user.}
00474   QFileDialog txtFile(\textcolor{keyword}{this});
00475   txtFile.setAcceptMode(QFileDialog::AcceptOpen);
00476   txtFile.setFileMode(QFileDialog::ExistingFile);
00477   txtFile.setNameFilter(tr(\textcolor{stringliteral}{"Text File Type 1(*.txt)"}));
00478   txtFile.setDirectory(QStandardPaths::standardLocations(
00479                          QStandardPaths::HomeLocation)[0]);
00480 
00481   \textcolor{comment}{// Check if user has canceled the opening.}
00482   \textcolor{keywordflow}{if} (txtFile.exec() != QDialog::Accepted) \{
00483     \textcolor{keywordflow}{return};
00484   \}
00485 
00486   \textcolor{comment}{// Grab filename.}
00487   QString fileName = txtFile.selectedFiles()[0];
00488 
00489   \textcolor{comment}{// Check if there is a project already opened.}
00490   \textcolor{keywordflow}{if} (project == NULL) \{
00491     \textcolor{comment}{// Create a new project.}
00492     on\_actionNew\_triggered();
00493 
00494     \textcolor{comment}{// Check if project has been created.}
00495     \textcolor{keywordflow}{if}(project == NULL) \{
00496       \textcolor{comment}{// User canceled, cancel import.}
00497       QMessageBox::critical(\textcolor{keyword}{this}, \textcolor{stringliteral}{"Need a project to import"},
00498                             \textcolor{stringliteral}{"A project is needed in order to import networks."},
00499                             QMessageBox::Ok);
00500       \textcolor{keywordflow}{return};
00501     \}
00502   \}
00503 
00504   \textcolor{comment}{// Try to import network.}
00505   \hyperlink{class_network}{Network} *network = \textcolor{keyword}{new} \hyperlink{class_network}{Network};
00506 
00507   \textcolor{keywordtype}{bool} importOk = \hyperlink{import_8cpp_aef466de21b145a0fdf215dd1a6409924}{importTxtType2}(fileName, network);
00508 
00509   \textcolor{comment}{// Impor success.}
00510   \textcolor{keywordflow}{if}(importOk) \{
00511     project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}.insert(network->\hyperlink{class_network_ab6643733a517f930c60b06f5ffd78186}{name}, network);
00512 
00513     \hyperlink{class_network_properties}{NetworkProperties} newNetwork(\textcolor{keyword}{this});
00514     newNetwork.setOptions(project, network);
00515 
00516     \textcolor{keywordflow}{if} (newNetwork.exec() == QDialog::Rejected) \{
00517       project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}.remove(network->\hyperlink{class_network_ab6643733a517f930c60b06f5ffd78186}{name});
00518       \textcolor{keyword}{delete} network;
00519       \textcolor{keywordflow}{return};
00520     \}
00521 
00522     ui->systemView->addNetwork(network);
00523     ui->systemView->zoomFit();
00524     \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00525   \} \textcolor{keywordflow}{else} \{
00526     \textcolor{keyword}{delete} network;
00527     \textcolor{keywordflow}{return};
00528   \}
00529 \}
00530 
00531 \textcolor{comment}{/*******************************************************************************}
00532 \textcolor{comment}{ * Import txt type 3 action.}
00533 \textcolor{comment}{ ******************************************************************************/}
00534 \textcolor{keywordtype}{void} QuickFlow::on\_action\_txt\_type\_3\_triggered()
00535 \{
00536   \textcolor{comment}{// Get file location from user.}
00537   QFileDialog txtFile(\textcolor{keyword}{this});
00538   txtFile.setAcceptMode(QFileDialog::AcceptOpen);
00539   txtFile.setFileMode(QFileDialog::ExistingFile);
00540   txtFile.setNameFilter(tr(\textcolor{stringliteral}{"Text File Type 1(*.txt)"}));
00541   txtFile.setDirectory(QStandardPaths::standardLocations(
00542                          QStandardPaths::HomeLocation)[0]);
00543 
00544   \textcolor{comment}{// Check if user has canceled the opening.}
00545   \textcolor{keywordflow}{if} (txtFile.exec() != QDialog::Accepted) \{
00546     \textcolor{keywordflow}{return};
00547   \}
00548 
00549   \textcolor{comment}{// Grab filename.}
00550   QString fileName = txtFile.selectedFiles()[0];
00551 
00552   \textcolor{comment}{// Check if there is a project already opened.}
00553   \textcolor{keywordflow}{if} (project == NULL) \{
00554     \textcolor{comment}{// Create a new project.}
00555     on\_actionNew\_triggered();
00556 
00557     \textcolor{comment}{// Check if project has been created.}
00558     \textcolor{keywordflow}{if}(project == NULL) \{
00559       \textcolor{comment}{// User canceled, cancel import.}
00560       QMessageBox::critical(\textcolor{keyword}{this}, \textcolor{stringliteral}{"Need a project to import"},
00561                             \textcolor{stringliteral}{"A project is needed in order to import networks."},
00562                             QMessageBox::Ok);
00563       \textcolor{keywordflow}{return};
00564     \}
00565   \}
00566 
00567   \textcolor{comment}{// Try to import network.}
00568   \hyperlink{class_network}{Network} *network = \textcolor{keyword}{new} \hyperlink{class_network}{Network};
00569 
00570   \textcolor{keywordtype}{bool} importOk = \hyperlink{import_8cpp_acd1a54d4b2a28043b1489f0be7423ecd}{importTxtType3}(fileName, network);
00571 
00572   \textcolor{comment}{// Impor success.}
00573   \textcolor{keywordflow}{if}(importOk) \{
00574     project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}.insert(network->\hyperlink{class_network_ab6643733a517f930c60b06f5ffd78186}{name}, network);
00575 
00576     \hyperlink{class_network_properties}{NetworkProperties} newNetwork(\textcolor{keyword}{this});
00577     newNetwork.setOptions(project, network);
00578 
00579     \textcolor{keywordflow}{if} (newNetwork.exec() == QDialog::Rejected) \{
00580       project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}.remove(network->\hyperlink{class_network_ab6643733a517f930c60b06f5ffd78186}{name});
00581       \textcolor{keyword}{delete} network;
00582       \textcolor{keywordflow}{return};
00583     \}
00584 
00585     ui->systemView->addNetwork(network);
00586     ui->systemView->zoomFit();
00587     \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00588   \} \textcolor{keywordflow}{else} \{
00589     \textcolor{keyword}{delete} network;
00590     \textcolor{keywordflow}{return};
00591   \}
00592 \}
00593 
00594 \textcolor{comment}{/*******************************************************************************}
00595 \textcolor{comment}{ * Cespedes action.}
00596 \textcolor{comment}{ ******************************************************************************/}
00597 \textcolor{keywordtype}{void} QuickFlow::on\_actionCespedes\_triggered()
00598 \{
00599   \textcolor{keywordflow}{if}(ui->actionShirmoharmmadi->isChecked()) \{
00600     ui->actionShirmoharmmadi->setChecked(\textcolor{keyword}{false});
00601   \}
00602 \}
00603 
00604 \textcolor{comment}{/*******************************************************************************}
00605 \textcolor{comment}{ * Shirmoharmmadi action.}
00606 \textcolor{comment}{ ******************************************************************************/}
00607 \textcolor{keywordtype}{void} QuickFlow::on\_actionShirmoharmmadi\_triggered()
00608 \{
00609   \textcolor{keywordflow}{if}(ui->actionCespedes->isChecked()) \{
00610     ui->actionCespedes->setChecked(\textcolor{keyword}{false});
00611   \}
00612 \}
00613 
00614 \textcolor{comment}{/*******************************************************************************}
00615 \textcolor{comment}{ * Sugiyama graph algorithm action.}
00616 \textcolor{comment}{ ******************************************************************************/}
00617 \textcolor{keywordtype}{void} QuickFlow::on\_actionSugiyama\_triggered()
00618 \{
00619 
00620   \textcolor{keywordflow}{foreach}(\hyperlink{class_network}{Network} *network, project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}) \{
00621     \hyperlink{class_redraw_network}{RedrawNetwork} redraw(network);
00622     redraw.sugiyama();
00623   \}
00624 
00625   \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00626   ui->systemView->zoomFit();
00627 \}
00628 
00629 \textcolor{comment}{/*******************************************************************************}
00630 \textcolor{comment}{ * Sugiyama fast graph algorithm action.}
00631 \textcolor{comment}{ ******************************************************************************/}
00632 \textcolor{keywordtype}{void} QuickFlow::on\_actionSugiyama\_Fast\_triggered()
00633 \{
00634   \textcolor{keywordflow}{foreach}(\hyperlink{class_network}{Network} *network, project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}) \{
00635     \hyperlink{class_redraw_network}{RedrawNetwork} redraw(network);
00636     redraw.sugiyamaFast();
00637   \}
00638 
00639   \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00640   ui->systemView->zoomFit();
00641 \}
00642 
00643 \textcolor{comment}{/*******************************************************************************}
00644 \textcolor{comment}{ *  Multi-level graph algorithm action.}
00645 \textcolor{comment}{ ******************************************************************************/}
00646 \textcolor{keywordtype}{void} QuickFlow::on\_actionMulti\_level\_triggered()
00647 \{
00648   \textcolor{keywordflow}{foreach}(\hyperlink{class_network}{Network} *network, project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}) \{
00649     \hyperlink{class_redraw_network}{RedrawNetwork} redraw(network);
00650     redraw.multiLevel();
00651   \}
00652 
00653   \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00654   ui->systemView->zoomFit();
00655 \}
00656 
00657 \textcolor{comment}{/*******************************************************************************}
00658 \textcolor{comment}{ * Search bar action.}
00659 \textcolor{comment}{ ******************************************************************************/}
00660 \textcolor{keywordtype}{void} QuickFlow::on\_actionSearch\_Bar\_triggered()
00661 \{
00662   \hyperlink{class_search_bar}{SearchBar} searchBar(\textcolor{keyword}{this});
00663   searchBar.setOptions(project);
00664 
00665   \textcolor{keywordflow}{if} (searchBar.exec() == QDialog::Accepted) \{
00666     QRectF fitRect = searchBar.bar()->sceneBoundingRect();
00667 
00668     fitRect.setX(fitRect.x() -100);
00669     fitRect.setY(fitRect.y() - 100);
00670     fitRect.setWidth(fitRect.width() + 100);
00671     fitRect.setHeight(fitRect.height() + 100);
00672 
00673     ui->systemView->fitInView(fitRect, Qt::KeepAspectRatio);
00674   \}
00675 \}
00676 
00677 \textcolor{comment}{/*******************************************************************************}
00678 \textcolor{comment}{ * Run action.}
00679 \textcolor{comment}{ ******************************************************************************/}
00680 \textcolor{keywordtype}{void} QuickFlow::on\_actionRun\_triggered()
00681 \{
00682   \textcolor{keywordflow}{foreach}(\hyperlink{class_network}{Network} *network, project->\hyperlink{class_project_aa98126154cab59769a431668e6f17daf}{networks}) \{
00683     \textcolor{keywordflow}{if}(ui->actionShirmoharmmadi->isChecked()) \{
00684 
00685       \hyperlink{class_shirmoharmmadi}{Shirmoharmmadi} fluxo(network);
00686       fluxo.solve();
00687 
00688       QMessageBox::information(\textcolor{keyword}{this}, \textcolor{stringliteral}{"Duration"},
00689                                \textcolor{stringliteral}{"Simulation duration: "} +
00690                                QString::number(fluxo.duration) + \textcolor{stringliteral}{" [ms] \(\backslash\)n"} +
00691                                \textcolor{stringliteral}{"Used iterations: "} + QString::number(fluxo.usedIterations),
00692                                QMessageBox::Ok);
00693     \} \textcolor{keywordflow}{else} \{
00694       \hyperlink{class_cespedes}{Cespedes} fluxo(network);
00695       fluxo.solve();
00696       QMessageBox::information(\textcolor{keyword}{this}, \textcolor{stringliteral}{"Duration"},
00697                                \textcolor{stringliteral}{"Simulation duration: "} +
00698                                QString::number(fluxo.duration) + \textcolor{stringliteral}{" [ms] \(\backslash\)n"} +
00699                                \textcolor{stringliteral}{"Used iterations: "} + QString::number(fluxo.usedIterations)
00700                                + \textcolor{stringliteral}{"\(\backslash\)nTotal Loss: "} + QString::number(fluxo.totalLoss.real()
00701                                    *network->\hyperlink{group___models_ga6fdbd7d04d12a3f1215c92e2e20eabdb}{powerBase}()) + \textcolor{stringliteral}{" Watts, "} +  QString::number(fluxo.
      totalLoss.imag()
00702                                        *network->\hyperlink{group___models_ga6fdbd7d04d12a3f1215c92e2e20eabdb}{powerBase}()) + \textcolor{stringliteral}{" VAR, "},
00703                                QMessageBox::Ok);
00704     \}
00705   \}
00706 
00707   \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00708 \}
00709 
00710 \textcolor{comment}{/*******************************************************************************}
00711 \textcolor{comment}{ * Settings action.}
00712 \textcolor{comment}{ ******************************************************************************/}
00713 \textcolor{keywordtype}{void} QuickFlow::on\_actionSettings\_triggered()
00714 \{
00715   \hyperlink{class_project_properties}{ProjectProperties} projectProperties(\textcolor{keyword}{this});
00716 
00717   projectProperties.setOptions(project);
00718 
00719   projectProperties.exec();
00720 \}
00721 
00722 \textcolor{comment}{/*******************************************************************************}
00723 \textcolor{comment}{ * About action.}
00724 \textcolor{comment}{ ******************************************************************************/}
00725 \textcolor{keywordtype}{void} QuickFlow::on\_actionAbout\_triggered()
00726 \{
00727   \hyperlink{class_about}{About} about(\textcolor{keyword}{this});
00728   about.exec();
00729 \}
00730 
00731 \textcolor{comment}{/*******************************************************************************}
00732 \textcolor{comment}{ * Edit bar action.}
00733 \textcolor{comment}{ ******************************************************************************/}
00734 \textcolor{keywordtype}{void} QuickFlow::on\_editBar(QObject *bar)
00735 \{
00736   \hyperlink{class_bar_properties}{BarProperties} barProperties(\textcolor{keyword}{this});
00737   barProperties.setOptions(project, static\_cast<Bar *>(bar));
00738 
00739   \textcolor{keywordflow}{if} (barProperties.exec() == QDialog::Accepted) \{
00740     \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00741   \}
00742 \}
00743 
00744 \textcolor{comment}{/*******************************************************************************}
00745 \textcolor{comment}{ * Edit line action.}
00746 \textcolor{comment}{ ******************************************************************************/}
00747 \textcolor{keywordtype}{void} QuickFlow::on\_editLine(QObject *line)
00748 \{
00749   \hyperlink{class_line_properties}{LineProperties} lineProperties(\textcolor{keyword}{this});
00750   lineProperties.setOptions(project, static\_cast<Line *>(line));
00751 
00752   \textcolor{keywordflow}{if} (lineProperties.exec() == QDialog::Accepted) \{
00753     \hyperlink{group___window_ga4b63ea5ca52a9eea14db0a22b5a133f8}{setAltered}(\textcolor{keyword}{true});
00754   \}
00755 \}
00756 
00757 \textcolor{comment}{/*******************************************************************************}
00758 \textcolor{comment}{ * Close event.}
00759 \textcolor{comment}{ ******************************************************************************/}
\hypertarget{quickflow_8cpp_source_l00760}{}\hyperlink{group___window_gac8cc1bb329961a0781ffed7b6f2ab402}{00760} \textcolor{keywordtype}{void} \hyperlink{group___window_gac8cc1bb329961a0781ffed7b6f2ab402}{QuickFlow::closeEvent}(QCloseEvent *event)
00761 \{
00762   \textcolor{comment}{// Hook to application exit.}
00763   \textcolor{comment}{// Check for unsaved changes.}
00764   \textcolor{keywordflow}{if} (altered\_) \{
00765     \textcolor{comment}{// Try to close project, saving the changes.}
00766     ui->actionClose->trigger();
00767 
00768     \textcolor{comment}{// Check for a  cancel}
00769     \textcolor{keywordflow}{if} (altered\_) \{
00770       \textcolor{comment}{// User doesnt want to quit}
00771       \textcolor{keyword}{event}->ignore();
00772       \textcolor{keywordflow}{return};
00773     \}
00774   \}
00775 
00776   saveSettings();
00777   \textcolor{keyword}{event}->accept();
00778 \}
00779 
00780 \textcolor{comment}{/*******************************************************************************}
00781 \textcolor{comment}{ * Load application settings.}
00782 \textcolor{comment}{ ******************************************************************************/}
00783 \textcolor{keywordtype}{void} QuickFlow::loadSettings()
00784 \{
00785   \textcolor{comment}{// systemView background.}
00786   QBrush bkbrush;
00787   bkbrush.setColor(settings->value(\textcolor{stringliteral}{"systemView\_background"}).value<QColor>());
00788   bkbrush.setStyle(Qt::SolidPattern);
00789   ui->systemView->setBackgroundBrush(bkbrush);
00790 \}
00791 
00792 \textcolor{comment}{/*******************************************************************************}
00793 \textcolor{comment}{ * Save application settings.}
00794 \textcolor{comment}{ ******************************************************************************/}
00795 \textcolor{keywordtype}{void} QuickFlow::saveSettings()
00796 \{
00797   \textcolor{comment}{// systemView background.}
00798   settings->setValue(\textcolor{stringliteral}{"systemView\_background"}, ui->systemView->backgroundBrush());
00799 
00800   \textcolor{comment}{// Save settings.}
00801   settings->sync();
00802 \}
00803 
00804 \textcolor{comment}{/*******************************************************************************}
00805 \textcolor{comment}{ * Create application settings.}
00806 \textcolor{comment}{ ******************************************************************************/}
00807 \textcolor{keywordtype}{void} QuickFlow::createSettings()
00808 \{
00809   \textcolor{comment}{// Save version.}
00810   settings->setValue(\textcolor{stringliteral}{"version"}, \hyperlink{group___window_gabfc3b1280bdae9a9c046d56b1459ab99}{kVersion});
00811 
00812 \textcolor{comment}{//  systemView background.}
00813   QBrush bkbrush;
00814   bkbrush.setColor(Qt::white);
00815   bkbrush.setStyle(Qt::SolidPattern);
00816   ui->systemView->setBackgroundBrush(bkbrush);
00817 
00818   \textcolor{comment}{// Store settings.}
00819   saveSettings();
00820 \}
00821 
00822 \textcolor{comment}{/*******************************************************************************}
00823 \textcolor{comment}{ * Upgrade application settings.}
00824 \textcolor{comment}{ ******************************************************************************/}
00825 \textcolor{keywordtype}{void} QuickFlow::upgradeSettings()
00826 \{
00827   \textcolor{comment}{// Remove everything and create a default.}
00828   settings->clear();
00829   createSettings();
00830 \}
00831 
00832 \textcolor{comment}{/*******************************************************************************}
00833 \textcolor{comment}{ * No project interface.}
00834 \textcolor{comment}{ ******************************************************************************/}
00835 \textcolor{keywordtype}{void} QuickFlow::noProjectInterface()
00836 \{
00837   \textcolor{comment}{// Project actions.}
00838   ui->actionNew->setEnabled(\textcolor{keyword}{true});
00839   ui->actionOpen->setEnabled(\textcolor{keyword}{true});
00840   ui->actionSave->setEnabled(\textcolor{keyword}{false});
00841   ui->actionSave\_as->setEnabled(\textcolor{keyword}{false});
00842   ui->actionClose->setEnabled(\textcolor{keyword}{false});
00843   ui->actionSettings->setEnabled(\textcolor{keyword}{false});
00844 
00845   \textcolor{comment}{// Simulation actions.}
00846   ui->actionRun->setEnabled(\textcolor{keyword}{false});
00847   ui->actionExport->setEnabled(\textcolor{keyword}{false});
00848 
00849   \textcolor{comment}{// Zoom actions.}
00850   ui->actionZoomFit->setEnabled(\textcolor{keyword}{false});
00851   ui->actionZoomIn->setEnabled(\textcolor{keyword}{false});
00852   ui->actionZoomOut->setEnabled(\textcolor{keyword}{false});
00853 
00854   \textcolor{comment}{// Power network actions}
00855   ui->actionAdd\_Network->setEnabled(\textcolor{keyword}{false});
00856   ui->actionAddBar->setEnabled(\textcolor{keyword}{false});
00857   ui->actionAddLine->setEnabled(\textcolor{keyword}{false});
00858   ui->actionSearch\_Bar->setEnabled(\textcolor{keyword}{false});
00859 
00860   \textcolor{comment}{// Algorithms actions.}
00861   ui->actionShirmoharmmadi->setEnabled(\textcolor{keyword}{false});
00862   ui->actionCespedes->setEnabled(\textcolor{keyword}{false});
00863   ui->actionSugiyama->setEnabled(\textcolor{keyword}{false});
00864   ui->actionSugiyama\_Fast->setEnabled(\textcolor{keyword}{false});
00865   ui->actionMulti\_level->setEnabled(\textcolor{keyword}{false});
00866 
00867   \textcolor{comment}{// Disable viewer.}
00868   ui->systemView->setEnabled(\textcolor{keyword}{false});
00869 \}
00870 
00871 \textcolor{comment}{/*******************************************************************************}
00872 \textcolor{comment}{ * Work interface.}
00873 \textcolor{comment}{ ******************************************************************************/}
00874 \textcolor{keywordtype}{void} QuickFlow::workInterface()
00875 \{
00876   \textcolor{comment}{// Project actions.}
00877   ui->actionNew->setEnabled(\textcolor{keyword}{true});
00878   ui->actionOpen->setEnabled(\textcolor{keyword}{true});
00879   ui->actionSave->setEnabled(\textcolor{keyword}{false});
00880   ui->actionSave\_as->setEnabled(\textcolor{keyword}{true});
00881   ui->actionClose->setEnabled(\textcolor{keyword}{true});
00882   ui->actionSettings->setEnabled(\textcolor{keyword}{true});
00883 
00884   \textcolor{comment}{// Simulation actions.}
00885   ui->actionRun->setEnabled(\textcolor{keyword}{true});
00886   ui->actionExport->setEnabled(\textcolor{keyword}{true});
00887 
00888   \textcolor{comment}{// Zoom actions.}
00889   ui->actionZoomFit->setEnabled(\textcolor{keyword}{true});
00890   ui->actionZoomIn->setEnabled(\textcolor{keyword}{true});
00891   ui->actionZoomOut->setEnabled(\textcolor{keyword}{true});
00892 
00893   \textcolor{comment}{// Power network actions}
00894   ui->actionAdd\_Network->setEnabled(\textcolor{keyword}{true});
00895   ui->actionAddBar->setEnabled(\textcolor{keyword}{true});
00896   ui->actionAddLine->setEnabled(\textcolor{keyword}{true});
00897   ui->actionSearch\_Bar->setEnabled(\textcolor{keyword}{true});
00898 
00899   \textcolor{comment}{// Algorithms actions.}
00900   ui->actionShirmoharmmadi->setEnabled(\textcolor{keyword}{true});
00901   ui->actionCespedes->setEnabled(\textcolor{keyword}{true});
00902   ui->actionSugiyama->setEnabled(\textcolor{keyword}{true});
00903   ui->actionSugiyama\_Fast->setEnabled(\textcolor{keyword}{true});
00904   ui->actionMulti\_level->setEnabled(\textcolor{keyword}{true});
00905 
00906   \textcolor{comment}{// Enable viewer}
00907   ui->systemView->setEnabled(\textcolor{keyword}{true});
00908 \}
00909 
00910 \textcolor{comment}{/*******************************************************************************}
00911 \textcolor{comment}{ * Connect Signals.}
00912 \textcolor{comment}{ ******************************************************************************/}
00913 \textcolor{keywordtype}{void} QuickFlow::connectSignals()
00914 \{
00915   connect(ui->systemView, SIGNAL(barProperties(QObject *)), \textcolor{keyword}{this},
00916           SLOT(on\_editBar(QObject *)));
00917 
00918   connect(ui->systemView, SIGNAL(lineProperties(QObject *)), \textcolor{keyword}{this},
00919           SLOT(on\_editLine(QObject *)));
00920 \}
00921 
00922 \textcolor{comment}{/*******************************************************************************}
00923 \textcolor{comment}{ * Disconnect Signals.}
00924 \textcolor{comment}{ ******************************************************************************/}
00925 \textcolor{keywordtype}{void} QuickFlow::disconnectSignals()
00926 \{
00927   disconnect(ui->systemView, SIGNAL(barProperties(QObject *)), \textcolor{keyword}{this},
00928              SLOT(on\_editBar(QObject *)));
00929 
00930   disconnect(ui->systemView, SIGNAL(lineProperties(QObject *)), \textcolor{keyword}{this},
00931              SLOT(on\_editLine(QObject *)));
00932 \}
00933 
00940 \textcolor{keywordtype}{void} QuickFlow::on\_actionExport\_image\_triggered()
00941 \{
00942 
00943   \textcolor{comment}{// Get file location from user.}
00944   QFileDialog imgFile(\textcolor{keyword}{this});
00945   imgFile.setAcceptMode(QFileDialog::AcceptSave);
00946   QStringList filters;
00947   filters << \textcolor{stringliteral}{"PNG (*.png)"};
00948   filters << \textcolor{stringliteral}{"JPG (*.jpg)"};
00949   filters << \textcolor{stringliteral}{"BMP (*.bmp)"};
00950 
00951   imgFile.setNameFilters(filters);
00952   QString initialPath = QStandardPaths::standardLocations(
00953                           QStandardPaths::DocumentsLocation)[0] + \textcolor{stringliteral}{"/QuickFlow"};
00954   imgFile.setDirectory(initialPath);
00955 
00956   \textcolor{comment}{// Check if user has canceled the opening.}
00957   \textcolor{keywordflow}{if} (imgFile.exec() != QDialog::Accepted) \{
00958     \textcolor{keywordflow}{return};
00959   \}
00960 
00961   QString imgPath =  imgFile.selectedFiles()[0];
00962 
00963   \textcolor{keywordtype}{double} w = ui->systemView->scene()->sceneRect().width();
00964   \textcolor{keywordtype}{double} h = ui->systemView->scene()->sceneRect().height();
00965 
00966   QImage img(static\_cast<int> (w), static\_cast<int> (h),
00967              QImage::Format\_ARGB32\_Premultiplied);
00968   img.fill(ui->systemView->backgroundBrush().color());
00969   QPainter p(&img);
00970   p.setRenderHint(QPainter::Antialiasing);
00971   ui->systemView->scene()->render(&p);
00972   p.end();
00973   img.save(imgPath);
00974 \}
\end{DoxyCode}
